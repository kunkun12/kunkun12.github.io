<!doctype html>
<html class="theme-next use-motion">
<head><meta name="generator" content="Hexo 3.8.0">
  

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">




  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5">


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.3.0rc4">






    <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.3.0rc4">




  <title> kunkun </title>
</head>

<body>
  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
    <a href="/" class="brand">
        <span class="logo">
          <i class="icon-logo"></i>
        </span>
        <span class="site-title">kunkun</span>
    </a>
</h1>


  <ul id="menu" class="menu">
    
      
      <li class="menu-item menu-item-home">
        <a href="/">
          <i class="menu-item-icon icon-home"></i> <br>
          é¦–é¡µ
        </a>
      </li>
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives">
          <i class="menu-item-icon icon-archives"></i> <br>
          å½’æ¡£
        </a>
      </li>
    
      
      <li class="menu-item menu-item-tags">
        <a href="/tags">
          <i class="menu-item-icon icon-tags"></i> <br>
          æ ‡ç­¾
        </a>
      </li>
    
  </ul>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
            
          

          <div id="posts" class="posts-expand">
            
  
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/12/03/es6-proxy/">
                es6-proxy
              </a>
            
          
        </h1>
      

      <div class="post-meta">
          <span class="post-time">
            
              å‘è¡¨äº 2018-12-03
            
          </span>
        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2018/12/03/es6-proxy/#comments">
              <span class="post-comments-count ds-thread-count" data-thread-key="2018/12/03/es6-proxy/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          
        

      </div>
    

    
      <div class="post-footer">
        

        

        
          <div class="post-eof the-shape"></div>
        
      </div>
    
  </div>


  
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/11/28/dart-lang-base/">
                Dart è¯­è¨€åŸºç¡€æ€»ç»“
              </a>
            
          
        </h1>
      

      <div class="post-meta">
          <span class="post-time">
            
              å‘è¡¨äº 2018-11-28
            
          </span>
        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2018/11/28/dart-lang-base/#comments">
              <span class="post-comments-count ds-thread-count" data-thread-key="2018/11/28/dart-lang-base/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <h1 id="Dart-è¯­è¨€åŸºç¡€æ€»ç»“"><a href="#Dart-è¯­è¨€åŸºç¡€æ€»ç»“" class="headerlink" title="Dart è¯­è¨€åŸºç¡€æ€»ç»“"></a>Dart è¯­è¨€åŸºç¡€æ€»ç»“</h1><p>Dart æ˜¯è°·æ­Œæ¨å‡ºçš„é¢å‘å¯¹è±¡çš„å¼ºç±»å‹è¯­è¨€ï¼Œåœ¨2011å¹´å‘å¸ƒï¼Œä¸€ç›´ä¸æ¸©ä¸ç«ã€‚æœ€è¿‘Flutterçš„å‡ºç°ï¼Œè®©Dartåˆèµ·æ­»å›ç”Ÿã€‚Dartæ”¯æŒJIT å’ŒAOT ä¸¤ç§ç¼–è¯‘æ–¹å¼ã€‚JITåœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œè®©APPæ–¹ä¾¿å®ç°Reloadï¼ŒAOTåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œæ¥ä¿è¯è¾ƒé«˜çš„æ€§èƒ½ã€‚<a href="https://blog.csdn.net/h1130189083/article/details/78302502" target="_blank" rel="noopener">å…³äºAOTå’ŒJIT</a> dartæ”¯æŒFlutterã€Webã€ä»¥åŠServerç«¯å¼€å‘</p>
<p>ä½“éªŒDartåŠŸèƒ½å¯ä»¥åœ¨<a href="https://dartpad.dartlang.org/" target="_blank" rel="noopener">dartpad</a>è¿›è¡Œ, ä»¥åŠ<a href="https://www.dartlang.org/guides/language/language-tour" target="_blank" rel="noopener">å…¥é—¨æ–‡æ¡£</a></p>
<h3 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h3><p>æ¯ä¸ªç¨‹åºçš„æ‰§è¡Œéƒ½ä»¥mainå‡½æ•°å¼€å§‹ï¼Œmainæ˜¯Dartç¨‹åºçš„å…¥å£ã€‚</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‰“å°æ—¥å¿—-dart"><a href="#æ‰“å°æ—¥å¿—-dart" class="headerlink" title="æ‰“å°æ—¥å¿— dart"></a>æ‰“å°æ—¥å¿— dart</h3><p>è¡¨è¾¾å¼è¦æ±‚å¿…é¡»ç»“å°¾åŠ åˆ†å·</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Hello Word"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸€äº›é‡è¦æ¦‚å¿µ"><a href="#ä¸€äº›é‡è¦æ¦‚å¿µ" class="headerlink" title="ä¸€äº›é‡è¦æ¦‚å¿µ"></a>ä¸€äº›é‡è¦æ¦‚å¿µ</h3><ul>
<li>ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œ Darté‡Œé¢ä¸€åˆ‡å˜é‡éƒ½æ˜¯objectã€æ¯ä¸€ä¸ªobjectéƒ½æ˜¯classçš„å®ä¾‹ã€ã€‚æ•°å­—ã€å¸ƒå°”ã€å‡½æ•°ã€null éƒ½æ˜¯ä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ç»§æ‰¿äº <code>Object</code> ç±»</li>
<li>dartè™½ç„¶æ˜¯å¼ºç±»å‹çš„è¯­è¨€ï¼Œä½†æ˜¯æ”¯æŒç±»å‹æ¨æ–­ï¼Œåœ¨å®šä¹‰å˜é‡çš„æ—¶å€™å¯ä¸å†™å˜é‡çš„ç±»å‹ã€‚</li>
<li>æ”¯æŒæ³›å‹</li>
<li>å‡½æ•°æ˜¯â€œä¸€ç­‰å…¬æ°‘â€,å¯ä»¥ä½œä¸ºå˜é‡åœ¨ä»£ç é—´åˆ°å¤„ä¼ é€’ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå‡½æ•°åµŒå¥—ã€‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½æœ‰è¿”å›å€¼ï¼Œé»˜è®¤è¿”å›null(è¿™ç‚¹ä¸JavaScriptç±»ä¼¼)</li>
<li>åœ¨class ä¸­ä»¥ ä¸‹åˆ’çº¿å¼€å¤´çš„å±æ€§ï¼Œä¸ºç§æœ‰å±æ€§ã€‚</li>
<li>å˜é‡å åªèƒ½ä»¥å­—æ¯å’Œä¸‹åˆ’çº¿å¼€å¤´,åé¢å¯ä»¥è·Ÿè¿™æ•°å­—ã€è‹±æ–‡å­—æ¯ã€ä¸‹åˆ’çº¿ã€‚</li>
</ul>
<h3 id="å˜é‡å£°æ˜"><a href="#å˜é‡å£°æ˜" class="headerlink" title="å˜é‡å£°æ˜"></a>å˜é‡å£°æ˜</h3><p>å˜é‡å£°æ˜ä¹‹å‰ä¸€èˆ¬è¦åŠ ä¸Šå˜é‡çš„ç±»å‹,å˜é‡å£°æ˜åæœªèµ‹å€¼ä¹‹ä¹‹å‰é»˜è®¤å€¼ä¸º<code>null</code>ã€‚ åƒ <code>int a</code> <code>String s</code>ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ <code>var</code> è®©ç¨‹åºåŠ¨æ€çš„æ¨æµ‹ç±»å‹ï¼Œç±»å‹ä¸€æ—¦ç¡®è®¤åï¼Œä¸å¯å†èµ‹å€¼å…¶ä»–ç±»å‹çš„æ•°æ®ã€‚</p>
<p>é€šè¿‡ <code>dynamic</code> å£°æ˜çš„å˜é‡ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶å˜æ›´ç±»å‹ æ¯”å¦‚<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">'kk'</span>; <span class="comment">// æ•ˆæœä¸String name ='kk' ç­‰åŒ</span></span><br><span class="line">    name = <span class="number">1</span>; <span class="comment">//ç¼–è¯‘æŠ¥é”™</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">    <span class="keyword">dynamic</span> name = <span class="string">'kk'</span>;</span><br><span class="line">    name=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">print</span>(name); <span class="comment">//1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬ä¸æ‰“ç®—æ”¹å˜ä¸€ä¸ªå˜é‡çš„å€¼å¯ä»¥ ä½¿ç”¨ <code>final</code> æˆ–è€… <code>const</code>ã€‚<code>const</code>æ¯”<code>final</code>æ›´åŠ ä¸¥æ ¼ï¼Œconstå¿…é¡»åœ¨ç¼–è¯‘æ—¶çŸ¥é“è¿™ä¸ªå¸¸é‡çš„å€¼ã€‚finalå¿…é¡»åœ¨å˜é‡å£°æ˜æ˜¯è¿›è¡Œåˆå§‹åŒ–ï¼Œfinalåªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ï¼Œå¯ä»¥æ˜¯å¸¸é‡ä»¥åŠåŠ¨æ€è®¡ç®—çš„ç»“æœå€¼<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> Func() &#123;</span><br><span class="line"><span class="comment">// ä»£ç </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="built_in">int</span> m1 = <span class="number">60</span>;</span><br><span class="line"><span class="keyword">final</span> <span class="built_in">int</span> m2 = Func(); <span class="comment">// æ­£ç¡®</span></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">int</span> n1 = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">int</span> n2 = Func(); <span class="comment">// é”™è¯¯,åœ¨ç¼–è¯‘çš„æ—¶å€™æ— æ³•ç¡®å®šå€¼ã€‚</span></span><br></pre></td></tr></table></figure></p>
<h4 id="å†…ç½®ç±»å‹"><a href="#å†…ç½®ç±»å‹" class="headerlink" title="å†…ç½®ç±»å‹"></a>å†…ç½®ç±»å‹</h4><p>Dartæ”¯æŒä»¥ä¸‹ä¸‹å†…ç½®ç±»å‹</p>
<ul>
<li>numbers æ•°å­—</li>
<li>strings å­—ç¬¦ä¸²</li>
<li>booleans å¸ƒå°”</li>
<li>listsï¼ˆarraysï¼‰ åˆ—è¡¨/æ•°ç»„</li>
<li>maps å­—å…¸</li>
<li>runes</li>
<li>symbols</li>
</ul>
<p>Darté‡Œé¢ æ‰€æœ‰çš„æ•°æ®ç±»å‹éƒ½å±äºå¯¹è±¡ç±»å‹ï¼Œæ¯ä¸ªç±»å‹éƒ½æœ‰å¯¹åº”çš„æ„é€ å‡½æ•°ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨ <code>Map</code> æ¥æ„é€ ä¸€ä¸ªï¼Œmap</p>
<h3 id="æ•°å­—ç±»å‹"><a href="#æ•°å­—ç±»å‹" class="headerlink" title="æ•°å­—ç±»å‹"></a>æ•°å­—ç±»å‹</h3><p>åŒ…å«ä¸¤ç§ <code>int</code> å’Œ <code>double</code></p>
<ul>
<li><a href="https://api.dartlang.org/stable/2.1.0/dart-core/int-class.html" target="_blank" rel="noopener">int</a>  æ ¹æ®ä¸åŒçš„å¹³å°æœ€å¤§64ä½ï¼Œå–å€¼èŒƒå›´ä¸º values can be from -2çš„63æ¬¡æ–¹ åˆ° 2çš„63æ¬¡æ–¹ - 1. å¦‚æœä¾¿ä»¥ä¸ºJavaScript åˆ™éµå¾ªjavascriptæ•°å€¼ç±»å‹çš„è§„åˆ™ï¼Œå–å€¼èŒƒå›´ -2çš„53æ¬¡æ–¹ åˆ° 2çš„53æ¬¡æ–¹ - 1.</li>
<li><a href="https://api.dartlang.org/stable/2.1.0/dart-core/double-class.html" target="_blank" rel="noopener">double</a> éµå¾ª IEEE 754 æ ‡å‡†çš„æµ®ç‚¹æ•°ã€‚ ä¸JavaScriptçš„æ•°å­—ç±»å‹ä¸€æ ·</li>
</ul>
<p>æ•°å­—ä¸å­—ç¬¦ä¸²ç±»å‹è½¬æ¢ <code>int.parse</code> <code>1.toString()</code><br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// String -&gt; int</span></span><br><span class="line"><span class="keyword">var</span> one = <span class="built_in">int</span>.parse(<span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">assert</span>(one == <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// String -&gt; double</span></span><br><span class="line"><span class="keyword">var</span> onePointOne = <span class="built_in">double</span>.parse(<span class="string">'1.1'</span>);</span><br><span class="line"><span class="keyword">assert</span>(onePointOne == <span class="number">1.1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// int -&gt; String</span></span><br><span class="line"><span class="built_in">String</span> oneAsString = <span class="number">1.</span>toString();</span><br><span class="line"><span class="keyword">assert</span>(oneAsString == <span class="string">'1'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// double -&gt; String</span></span><br><span class="line"><span class="built_in">String</span> piAsString = <span class="number">3.14159</span>.toStringAsFixed(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">assert</span>(piAsString == <span class="string">'3.14'</span>);</span><br></pre></td></tr></table></figure></p>
<h4 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a><a href="https://api.dartlang.org/stable/2.1.0/dart-core/String-class.html" target="_blank" rel="noopener">å­—ç¬¦ä¸²</a></h4><ul>
<li>åŸºäºUTF-16ç¼–ç è§„åˆ™ã€‚å®šä¹‰å­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨åŒå¼•å·æˆ–è€…å•å¼•å·ã€‚ä¸<code>JavaScript</code>ä¸€è‡´ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ <code>${å˜é‡}</code>çš„å½¢å¼å®ç°å­—ç¬¦ä¸²æ’å€¼ã€‚å®ç°æ‹¼æ¥å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡<code>+</code> æ‹¼æ¥ï¼Œå­—ç¬¦ä¸²ä¸æ•°å­—ä¸èƒ½ç›¸åŠ ã€‚Darté‡Œé¢ä¸éœ€è¦ä½¿ç”¨åå¼•å·ï¼Œè¿™ç‚¹ä¸JSä¸åŒã€‚</li>
<li>å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªå•å¼•å·æˆ–è€…ä¸‰ä¸ªåŒå¼•å·å®ç°å¤šè¡Œçš„å­—ç¬¦ä¸²ã€‚å¦‚</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="string">'''</span></span><br><span class="line"><span class="string">You can create</span></span><br><span class="line"><span class="string">multi-line strings like this one.</span></span><br><span class="line"><span class="string">'''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s2 = <span class="string">"""This is also a</span></span><br><span class="line"><span class="string">multi-line string."""</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>åŠ  <code>r</code>å‰ç¼€æ¥è¡¨ç¤ºåŸå§‹çš„å­—ç¬¦ä¸² æ¯”å¦‚</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">r'In a raw string, not even \n gets special treatment.'</span>;</span><br></pre></td></tr></table></figure>
<h4 id="å¸ƒå°”å€¼"><a href="#å¸ƒå°”å€¼" class="headerlink" title="å¸ƒå°”å€¼"></a>å¸ƒå°”å€¼</h4><p>åŒ…å«ä¸¤ä¸ªobject <code>true</code> å’Œ <code>false</code> .å—é™äºDartç±»å‹å®‰å…¨é™åˆ¶ï¼Œåœ¨ifåˆ¤æ–­æ¡ä»¶åˆ¤æ–­ä»¥åŠassertæ¥å—çš„å€¼å¿…é¡»æ˜¯å¸ƒå°”ç±»å‹çš„</p>
<h4 id="List"><a href="#List" class="headerlink" title="List"></a><a href="https://api.dartlang.org/stable/2.1.0/dart-core/List-class.html" target="_blank" rel="noopener">List</a></h4><p>Darté‡Œé¢æ•°ç»„è¢«ç§°ä¸ºåˆ—è¡¨å¯¹è±¡ï¼Œå¯ä»¥åƒJavaScriptä¸­çš„æ–¹å¼æ¥å®šä¹‰åˆ—è¡¨,é€šè¿‡è®¾ç½®<code>length</code>å¯ä»¥æ”¹å˜æ•°ç»„çš„å¤§å°ï¼ˆä¸JavaScriptä¸€è‡´ï¼‰ã€‚æ¯”å¦‚</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> l = [<span class="string">'å¼ ä¸‰'</span>,<span class="string">'æå››'</span>,<span class="string">'ç‹äº”'</span>];</span><br></pre></td></tr></table></figure>
<h4 id="Map-ã€‚é”®å€¼å¯¹çš„å¯¹è±¡è¢«ç§°ä¸º-Mapï¼ŒKeyå¯ä»¥ä¸ºä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼Œä½†ä¸èƒ½é‡å¤ã€‚å¯ä»¥é€šè¿‡å­—é¢é‡-ä¹Ÿå¯ä»¥é€šè¿‡-Mapå…³é”®å­—æ¥å®šä¹‰"><a href="#Map-ã€‚é”®å€¼å¯¹çš„å¯¹è±¡è¢«ç§°ä¸º-Mapï¼ŒKeyå¯ä»¥ä¸ºä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼Œä½†ä¸èƒ½é‡å¤ã€‚å¯ä»¥é€šè¿‡å­—é¢é‡-ä¹Ÿå¯ä»¥é€šè¿‡-Mapå…³é”®å­—æ¥å®šä¹‰" class="headerlink" title="Map ã€‚é”®å€¼å¯¹çš„å¯¹è±¡è¢«ç§°ä¸º Mapï¼ŒKeyå¯ä»¥ä¸ºä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼Œä½†ä¸èƒ½é‡å¤ã€‚å¯ä»¥é€šè¿‡å­—é¢é‡ ä¹Ÿå¯ä»¥é€šè¿‡ Mapå…³é”®å­—æ¥å®šä¹‰"></a><a href="https://api.dartlang.org/stable/2.1.0/dart-core/Map-class.html" target="_blank" rel="noopener">Map</a> ã€‚é”®å€¼å¯¹çš„å¯¹è±¡è¢«ç§°ä¸º Mapï¼ŒKeyå¯ä»¥ä¸ºä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼Œä½†ä¸èƒ½é‡å¤ã€‚å¯ä»¥é€šè¿‡å­—é¢é‡ ä¹Ÿå¯ä»¥é€šè¿‡ <code>Map</code>å…³é”®å­—æ¥å®šä¹‰</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gifts= &#123;</span><br><span class="line">    <span class="string">'first'</span>:<span class="string">'partridge'</span>,</span><br><span class="line">    <span class="string">'second'</span>:<span class="string">'turtledoves'</span>,</span><br><span class="line">    <span class="string">'fifth'</span>: <span class="string">'golden rings'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> gifts2 = <span class="built_in">Map</span>();</span><br><span class="line">gifts[<span class="string">'first'</span>] = <span class="string">'partridge'</span>;</span><br><span class="line">gifts[<span class="string">'second'</span>] = <span class="string">'turtledoves'</span>;</span><br><span class="line">gifts[<span class="string">'fifth'</span>] = <span class="string">'golden rings'</span>;</span><br></pre></td></tr></table></figure>
<h4 id="runes"><a href="#runes" class="headerlink" title="runes"></a>runes</h4><p>Dart ä¸­ runes æ˜¯ UTF-32 å­—ç¬¦é›†çš„ string å¯¹è±¡ã€‚<br>Unicodeæ˜¯ä¸€å¥—å­—ç¬¦é›†ï¼Œæ¶µç›–äº†ç›®å‰äººç±»ä½¿ç”¨çš„æ‰€æœ‰å­—ç¬¦ï¼Œ ä¸ºä¸–ç•Œä¸Šçš„æ¯ä¸€ä¸ªå­—ç¬¦æä¾›ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—ç¼–å·(Code Point)æ¥è¡¨ç¤ºï¼Œç›®å‰å­—ç¬¦é›†è¿˜å¯¹åº”ä¸åŒçš„ç¼–ç æ–¹æ¡ˆ(æ¯”å¦‚UTF-8ï¼ŒUTF-16.UTF-32ç­‰)ï¼Œæ¥æ–¹ä¾¿è®¡ç®—æœºè¿˜å­˜å‚¨ï¼ŒåŒä¸€ä¸ªå­—ç¬¦ç”¨ä¸åŒçš„ç¼–ç æ–¹æ¡ˆå¯¹åº”çš„å­—èŠ‚è¡¨ç¤ºä¸åŒï¼Œç”±äºDartå­—ç¬¦ä¸²é‡‡ç”¨çš„æ˜¯UTF-16ç¼–ç è§„åˆ™ï¼Œå¦‚æœè¦è¡¨ç¤ºUTF-32ç¼–ç çš„å­—ç¬¦ éœ€è¦ç”¨ä¸€äº›ç‰¹æ®Šçš„è¯­æ³•ã€‚é€šå¸¸æƒ…å†µä½¿ç”¨ <code>\uXXXX</code> æ¥è¡¨ç¤ºä¸€ä¸ªç ç‚¹ï¼Œè¿™é‡Œçš„XXXXæ˜¯ä¸€ä¸ª4ä½çš„16è¿›åˆ¶å€¼ï¼Œä¾‹å¦‚ â™¥å­—ç¬¦çš„ç ç‚¹æ˜¯ <code>\u2665</code>,å¯¹äºå¤§äºæˆ–è€…å°äº 4ä½16è¿›åˆ¶çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¤§æ‹¬å·æ¥åŒ…è£¹æ•°å­— ï¼Œå¦‚ğŸ˜†è¡¨æƒ…ç¬¦å·æ˜¯ <code>\u{1f600}</code><br>å­—ç¬¦ä¸²ç±»å‹æœ‰å‡ ä¸ªå±æ€§å¯ä»¥æ¥æå–runeçš„ä¿¡æ¯ï¼Œ<code>codeUnitAt</code>  ç”¨æ¥è·å– UTF-16 å­—ç¬¦é›†çš„å­—ç¬¦ã€‚ä½¿ç”¨runes æ¥è·å– UTF-32 å­—ç¬¦é›†ä¸­çš„å­—ç¬¦ã€‚ä½¿ç”¨<code>runes</code>å¯ä»¥è·å–å­—ç¬¦ä¸²çš„rune  <a href="https://api.dartlang.org/stable/2.1.0/dart-core/Runes-class.html" target="_blank" rel="noopener">runeæ›´å¤šAPIå‚è€ƒ</a></p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a =<span class="string">'ğŸ˜†å¥½å¥½å­¦ä¹ ,'</span>;</span><br><span class="line"><span class="built_in">print</span>(a.codeUnitAt(<span class="number">0</span>)); <span class="comment">// 55357</span></span><br><span class="line"><span class="built_in">print</span>(a.codeUnits);<span class="comment">//[55357, 56838, 22909, 22909, 23398, 20064, 44]</span></span><br><span class="line"><span class="built_in">print</span>(a.runes.toList());<span class="comment">//[128518, 22909, 22909, 23398, 20064, 44]</span></span><br></pre></td></tr></table></figure>
<h4 id="Symbol-ä¸å¸¸ç”¨-ï¼Œåœ¨Dartä¸­æ˜¯ä¸é€æ˜çš„ï¼Œä¿å­˜å¯¹äººçš„å¯è¯»çš„å­—ç¬¦ä¸²ä»¥åŠè¢«è®¡ç®—æœºä¼˜åŒ–è¿‡çš„å­—ç¬¦ä¸²çš„çš„è”ç³»ï¼Œç”¨æ¥è¡¨ç¤ºåå°„åçš„å…ƒæ•°æ®ä¿¡æ¯-ã€‚å¯ä»¥ç»™ç±»åä»¥åŠå‡½æ•°å-å£°æ˜ä¸º-symbolç±»å‹-ä¸€èˆ¬ç”¨äºåå°„æ“ä½œ-å¯ä»¥å‚è€ƒ-gt-gt"><a href="#Symbol-ä¸å¸¸ç”¨-ï¼Œåœ¨Dartä¸­æ˜¯ä¸é€æ˜çš„ï¼Œä¿å­˜å¯¹äººçš„å¯è¯»çš„å­—ç¬¦ä¸²ä»¥åŠè¢«è®¡ç®—æœºä¼˜åŒ–è¿‡çš„å­—ç¬¦ä¸²çš„çš„è”ç³»ï¼Œç”¨æ¥è¡¨ç¤ºåå°„åçš„å…ƒæ•°æ®ä¿¡æ¯-ã€‚å¯ä»¥ç»™ç±»åä»¥åŠå‡½æ•°å-å£°æ˜ä¸º-symbolç±»å‹-ä¸€èˆ¬ç”¨äºåå°„æ“ä½œ-å¯ä»¥å‚è€ƒ-gt-gt" class="headerlink" title="Symbol ä¸å¸¸ç”¨ ï¼Œåœ¨Dartä¸­æ˜¯ä¸é€æ˜çš„ï¼Œä¿å­˜å¯¹äººçš„å¯è¯»çš„å­—ç¬¦ä¸²ä»¥åŠè¢«è®¡ç®—æœºä¼˜åŒ–è¿‡çš„å­—ç¬¦ä¸²çš„çš„è”ç³»ï¼Œç”¨æ¥è¡¨ç¤ºåå°„åçš„å…ƒæ•°æ®ä¿¡æ¯ ã€‚å¯ä»¥ç»™ç±»åä»¥åŠå‡½æ•°å å£°æ˜ä¸º symbolç±»å‹,ä¸€èˆ¬ç”¨äºåå°„æ“ä½œ å¯ä»¥å‚è€ƒ&gt;&gt;"></a>Symbol ä¸å¸¸ç”¨ ï¼Œåœ¨Dartä¸­æ˜¯ä¸é€æ˜çš„ï¼Œä¿å­˜å¯¹äººçš„å¯è¯»çš„å­—ç¬¦ä¸²ä»¥åŠè¢«è®¡ç®—æœºä¼˜åŒ–è¿‡çš„å­—ç¬¦ä¸²çš„çš„è”ç³»ï¼Œç”¨æ¥è¡¨ç¤ºåå°„åçš„å…ƒæ•°æ®ä¿¡æ¯ ã€‚å¯ä»¥ç»™ç±»åä»¥åŠå‡½æ•°å å£°æ˜ä¸º symbolç±»å‹,ä¸€èˆ¬ç”¨äºåå°„æ“ä½œ <a href="https://www.tutorialspoint.com/dart_programming/dart_programming_symbol.htm" target="_blank" rel="noopener">å¯ä»¥å‚è€ƒ&gt;&gt;</a></h4><h4 id="å‡½æ•°-æ¯ä¸ªå‡½æ•°éƒ½å±äºFunctionç±»çš„å®ä¾‹ï¼Œå‡½æ•°å¯ä»¥ä½œä¸ºå€¼èµ‹å€¼ä¸ºä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ã€ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼"><a href="#å‡½æ•°-æ¯ä¸ªå‡½æ•°éƒ½å±äºFunctionç±»çš„å®ä¾‹ï¼Œå‡½æ•°å¯ä»¥ä½œä¸ºå€¼èµ‹å€¼ä¸ºä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ã€ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼" class="headerlink" title="å‡½æ•° æ¯ä¸ªå‡½æ•°éƒ½å±äºFunctionç±»çš„å®ä¾‹ï¼Œå‡½æ•°å¯ä»¥ä½œä¸ºå€¼èµ‹å€¼ä¸ºä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ã€ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼"></a>å‡½æ•° æ¯ä¸ªå‡½æ•°éƒ½å±äº<code>Function</code>ç±»çš„å®ä¾‹ï¼Œå‡½æ•°å¯ä»¥ä½œä¸ºå€¼èµ‹å€¼ä¸ºä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ã€ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> Add(<span class="built_in">int</span> a,<span class="built_in">int</span> b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¯ä»¥å¿½ç•¥è¿”å›å€¼ç±»å‹</span></span><br><span class="line"><span class="built_in">int</span> Add(<span class="built_in">int</span> a,<span class="built_in">int</span> b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼ES6ä¸­çš„ ç®­å¤´å‡½æ•° </span></span><br><span class="line"><span class="built_in">int</span> Add(<span class="built_in">int</span> a,<span class="built_in">int</span> b)=&gt;a+b;</span><br><span class="line"><span class="comment">//å‡½æ•°ä½œä¸ºå‚æ•°</span></span><br><span class="line">list.forEach((item) =&gt; <span class="built_in">print</span>(item));</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½œä¸ºè¿”å›å€¼</span></span><br><span class="line"><span class="built_in">Function</span> makeAdder(<span class="built_in">int</span> addBy) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span> i) =&gt; addBy + i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è°ƒç”¨çš„æ—¶å€™å¯ä»¥æŒ‡å®šå‚æ•°çš„åç§°</span></span><br><span class="line"><span class="built_in">int</span> Add(&#123;<span class="built_in">int</span> a,<span class="built_in">int</span> b&#125;)=&gt;a+b;</span><br><span class="line"><span class="comment">// Add(a:1,b:2) </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Scrollbar(&#123;Key key, <span class="meta">@required</span> Widget child&#125;)&#123;&#125; <span class="comment">// @requiredæŒ‡å®šå¿…å¡«çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// []æŒ‡å®šå¯é€‰å‚æ•°</span></span><br><span class="line"><span class="built_in">String</span> say(<span class="built_in">String</span> from, <span class="built_in">String</span> msg, [<span class="built_in">String</span> device]) &#123;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="string">'<span class="subst">$from</span> says <span class="subst">$msg<span class="string">';</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">    if (device != null) &#123;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">        result = '</span></span><span class="subst">$result</span> with a <span class="subst">$device<span class="string">';</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">    &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">    return result;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">//æ”¯æŒç»™å‚æ•°é»˜è®¤å€¼ </span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">int Add(&#123;int a=1,int b=1&#125;)=&gt;a+b;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">Add(a:3)   //4</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string"></span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">// åŒ¿åå‡½æ•°</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">var list = ['</span></span>apples'</span>, <span class="string">'bananas'</span>, <span class="string">'oranges'</span>];</span><br><span class="line">list.forEach((item) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'<span class="subst">$&#123;list.indexOf(item)&#125;</span>: <span class="subst">$item<span class="string">');</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="string">&#125;);</span></span></span></span><br></pre></td></tr></table></figure>
<h4 id="main-ç¨‹åºçš„å…¥å£ã€æ¯ä¸ªç¨‹åºé¡¶éƒ¨å¿…æœ‰ä¸€ä¸ªmainå‡½æ•°-è¿”å›å€¼ä¸º-voidï¼Œæœ‰é»˜è®¤çš„-List-lt-String-gt-ç±»å‹çš„å‚æ•°ã€‚"><a href="#main-ç¨‹åºçš„å…¥å£ã€æ¯ä¸ªç¨‹åºé¡¶éƒ¨å¿…æœ‰ä¸€ä¸ªmainå‡½æ•°-è¿”å›å€¼ä¸º-voidï¼Œæœ‰é»˜è®¤çš„-List-lt-String-gt-ç±»å‹çš„å‚æ•°ã€‚" class="headerlink" title="main ç¨‹åºçš„å…¥å£ã€æ¯ä¸ªç¨‹åºé¡¶éƒ¨å¿…æœ‰ä¸€ä¸ªmainå‡½æ•° è¿”å›å€¼ä¸º voidï¼Œæœ‰é»˜è®¤çš„ List&lt;String&gt;ç±»å‹çš„å‚æ•°ã€‚"></a>main ç¨‹åºçš„å…¥å£ã€æ¯ä¸ªç¨‹åºé¡¶éƒ¨å¿…æœ‰ä¸€ä¸ªmainå‡½æ•° è¿”å›å€¼ä¸º voidï¼Œæœ‰é»˜è®¤çš„ <code>List&lt;String&gt;</code>ç±»å‹çš„å‚æ•°ã€‚</h4><h4 id="è¯æ³•ä½œç”¨åŸŸ-é™æ€ä½œç”¨åŸŸï¼‰ï¼ŒJavaScriptç±»ä¼¼ï¼Œåœ¨ç¼–å†™ä»£ç çš„æ—¶å€™å°±å†³å®šäº†å˜é‡çš„ä½œç”¨åŸŸ"><a href="#è¯æ³•ä½œç”¨åŸŸ-é™æ€ä½œç”¨åŸŸï¼‰ï¼ŒJavaScriptç±»ä¼¼ï¼Œåœ¨ç¼–å†™ä»£ç çš„æ—¶å€™å°±å†³å®šäº†å˜é‡çš„ä½œç”¨åŸŸ" class="headerlink" title="è¯æ³•ä½œç”¨åŸŸ(é™æ€ä½œç”¨åŸŸï¼‰ï¼ŒJavaScriptç±»ä¼¼ï¼Œåœ¨ç¼–å†™ä»£ç çš„æ—¶å€™å°±å†³å®šäº†å˜é‡çš„ä½œç”¨åŸŸ"></a>è¯æ³•ä½œç”¨åŸŸ(é™æ€ä½œç”¨åŸŸï¼‰ï¼ŒJavaScriptç±»ä¼¼ï¼Œåœ¨ç¼–å†™ä»£ç çš„æ—¶å€™å°±å†³å®šäº†å˜é‡çš„ä½œç”¨åŸŸ</h4><h4 id="é—­åŒ…-å‡½æ•°å†…éƒ¨è®¿é—®å¤–åŒ…çš„å˜é‡ï¼Œå¤–åŒ…çš„å˜é‡æ— æ³•å¾—åˆ°é‡Šæ”¾ã€‚ä¸JavaScripté—­åŒ…ç±»ä¼¼ã€‚"><a href="#é—­åŒ…-å‡½æ•°å†…éƒ¨è®¿é—®å¤–åŒ…çš„å˜é‡ï¼Œå¤–åŒ…çš„å˜é‡æ— æ³•å¾—åˆ°é‡Šæ”¾ã€‚ä¸JavaScripté—­åŒ…ç±»ä¼¼ã€‚" class="headerlink" title="é—­åŒ… å‡½æ•°å†…éƒ¨è®¿é—®å¤–åŒ…çš„å˜é‡ï¼Œå¤–åŒ…çš„å˜é‡æ— æ³•å¾—åˆ°é‡Šæ”¾ã€‚ä¸JavaScripté—­åŒ…ç±»ä¼¼ã€‚"></a>é—­åŒ… å‡½æ•°å†…éƒ¨è®¿é—®å¤–åŒ…çš„å˜é‡ï¼Œå¤–åŒ…çš„å˜é‡æ— æ³•å¾—åˆ°é‡Šæ”¾ã€‚ä¸JavaScripté—­åŒ…ç±»ä¼¼ã€‚</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span> addCount()&#123;</span><br><span class="line">    <span class="built_in">int</span> count =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span>  ()=&gt;count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">    <span class="keyword">var</span> countFn = addCount();</span><br><span class="line">    <span class="built_in">int</span> a=countFn();</span><br><span class="line">    <span class="built_in">int</span> b = countFn();</span><br><span class="line">        <span class="built_in">print</span>(a); <span class="comment">//0</span></span><br><span class="line">        <span class="built_in">print</span>(b); <span class="comment">//1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ“ä½œç¬¦-amp-gt-ç­‰ç­‰ä¹‹ç±»çš„ï¼Œè¿™ä¸ªè·Ÿå…¶ä»–è¯­è¨€æ²¡å•¥åŒºåˆ«ä¸æäº†-dartä¸­æ²¡æœ‰"><a href="#æ“ä½œç¬¦-amp-gt-ç­‰ç­‰ä¹‹ç±»çš„ï¼Œè¿™ä¸ªè·Ÿå…¶ä»–è¯­è¨€æ²¡å•¥åŒºåˆ«ä¸æäº†-dartä¸­æ²¡æœ‰" class="headerlink" title="æ“ä½œç¬¦ &amp; | ~ ++ -- + - * == &gt;= ç­‰ç­‰ä¹‹ç±»çš„ï¼Œè¿™ä¸ªè·Ÿå…¶ä»–è¯­è¨€æ²¡å•¥åŒºåˆ«ä¸æäº† (dartä¸­æ²¡æœ‰ ===)"></a>æ“ä½œç¬¦ <code>&amp;</code> <code>|</code> <code>~</code> <code>++</code> <code>--</code> <code>+</code> <code>-</code> <code>*</code> <code>==</code> <code>&gt;=</code> ç­‰ç­‰ä¹‹ç±»çš„ï¼Œè¿™ä¸ªè·Ÿå…¶ä»–è¯­è¨€æ²¡å•¥åŒºåˆ«ä¸æäº† (dartä¸­æ²¡æœ‰ <code>===</code>)</h3><h4 id="å±‚å è®¿é—®ç¬¦å·-ï¼ˆJSä¸­æ²¡æœ‰è¿™ä¸ªï¼‰ï¼Œå¯ä»¥è¿ç»­è®¿é—®åŒä¸€ä¸ªå¯¹è±¡çš„å±æ€§"><a href="#å±‚å è®¿é—®ç¬¦å·-ï¼ˆJSä¸­æ²¡æœ‰è¿™ä¸ªï¼‰ï¼Œå¯ä»¥è¿ç»­è®¿é—®åŒä¸€ä¸ªå¯¹è±¡çš„å±æ€§" class="headerlink" title="å±‚å è®¿é—®ç¬¦å· ï¼ˆJSä¸­æ²¡æœ‰è¿™ä¸ªï¼‰ï¼Œå¯ä»¥è¿ç»­è®¿é—®åŒä¸€ä¸ªå¯¹è±¡çš„å±æ€§"></a>å±‚å è®¿é—®ç¬¦å· ï¼ˆJSä¸­æ²¡æœ‰è¿™ä¸ªï¼‰ï¼Œå¯ä»¥è¿ç»­è®¿é—®åŒä¸€ä¸ªå¯¹è±¡çš„å±æ€§</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">querySelector</span>(<span class="string">'#confirm'</span>) <span class="comment">// Get an object.</span></span><br><span class="line">  ..text = <span class="string">'Confirm'</span> <span class="comment">// Use its members.</span></span><br><span class="line">  ..classes.add(<span class="string">'important'</span>)</span><br><span class="line">  ..onClick.listen((e) =&gt; <span class="built_in">window</span>.alert(<span class="string">'Confirmed!'</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">var</span> button = <span class="built_in">querySelector</span>(<span class="string">'#confirm'</span>);</span><br><span class="line">button.text = <span class="string">'Confirm'</span>;</span><br><span class="line">button.classes.add(<span class="string">'important'</span>);</span><br><span class="line">button.onClick.listen((e) =&gt; <span class="built_in">window</span>.alert(<span class="string">'Confirmed!'</span>));</span><br></pre></td></tr></table></figure>
<h4 id="æ§åˆ¶è¯­å¥"><a href="#æ§åˆ¶è¯­å¥" class="headerlink" title="æ§åˆ¶è¯­å¥"></a>æ§åˆ¶è¯­å¥</h4><ul>
<li>if/else if/else</li>
<li>whileã€ do-whileã€ </li>
<li>switch/case</li>
<li>for </li>
<li>break/continue</li>
<li>Assert </li>
</ul>
<h4 id="å¼‚å¸¸-Throw-Catch-Finally"><a href="#å¼‚å¸¸-Throw-Catch-Finally" class="headerlink" title="å¼‚å¸¸  Throw/Catch/Finally"></a>å¼‚å¸¸  Throw/Catch/Finally</h4><h4 id="ç±»-Class"><a href="#ç±»-Class" class="headerlink" title="ç±» Class"></a>ç±» Class</h4><ul>
<li><p>å®ä¾‹å˜é‡ æ„é€ </p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">  <span class="built_in">num</span> x; <span class="comment">// å®ä¾‹å˜é‡ é»˜è®¤ä¸º null</span></span><br><span class="line">  <span class="built_in">num</span> y=<span class="number">0</span>; <span class="comment">//åˆå§‹å€¼ä¸º0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> point = Point();</span><br><span class="line">point.x = <span class="number">4</span>; <span class="comment">// èµ‹å€¼</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ„é€ å‡½æ•° å¯ä»¥åœ¨ç±»å†…éƒ¨å£°æ˜ä¸€ä¸ªä¸ç±»åä¸€æ ·çš„æˆå‘˜å‡½æ•°ä½œä¸ºå‡½æ•°</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="built_in">num</span> x, y;</span><br><span class="line">    Point(<span class="built_in">num</span> x, <span class="built_in">num</span> y=<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€å•ä¸º</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="built_in">num</span> x, y;</span><br><span class="line">    Point(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y=<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å‘½åçš„æ„é€ å‡½æ•°,å‘½åçš„æ„é€ å‡½æ•°ä¸èƒ½è¢«ç»§æ‰¿ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨è°ƒç”¨</p>
</li>
</ul>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="built_in">num</span> x, y;</span><br><span class="line"></span><br><span class="line">    Point(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line">    </span><br><span class="line">    Point.origin() &#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>é‡å®šå‘æ„é€ å‡½æ•°ï¼Œ</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="built_in">num</span> x, y;</span><br><span class="line">    Point(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line">    Point.alongXAxis(<span class="built_in">num</span> x) : <span class="keyword">this</span>(x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœåœ¨å¯¹è±¡ä¸ä¼šåœ¨è¿è¡Œæ—¶è¢«ä¿®æ”¹ï¼Œå¯ä»¥å®šä¹‰ä¸ºå¸¸é‡</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImmutablePoint</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> ImmutablePoint origin = <span class="keyword">const</span> ImmutablePoint(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">num</span> x, y;</span><br><span class="line">    <span class="keyword">const</span> ImmutablePoint(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å·¥å‚æ„é€ å‡½æ•° ä½¿ç”¨ <code>factory</code> å£°æ˜å·¥å‚æ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜æœºåˆ¶é¿å…ä¸æ–­åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œå·¥å‚æ„é€ å‡½æ•°ä¸èƒ½è®¿é—®this</p>
</li>
<li>æˆå‘˜æ–¹æ³•ã€ä»¥åŠé™æ€æ–¹æ³•ï¼Œé™æ€å±æ€§</li>
<li>å±æ€§ Getters and setters ï¼ˆä¸JSä¸­çš„ç±»ä¼¼ ï¼‰èµ‹å€¼æˆ–è€…å–å€¼çš„æ—¶å€™ è‡ªåŠ¨ä¼šè°ƒç”¨æ–¹æ³•</li>
<li>æŠ½è±¡ç±» æŠ½è±¡æ–¹æ³• ã€‚<code>abstract</code>å…³é”®å­—å‰ç¼€ï¼ŒæŠ½è±¡æ–¹æ³•åªèƒ½å­˜åœ¨äºæŠ½è±¡ç±»ä¸­ï¼Œç”¨æ¥å®šä¹‰æ¥å£ã€‚ä¸å®ç°å…·ä½“çš„å·¥ä½œã€‚</li>
<li><p>æ˜¾å¼å®šä¹‰æ¥å£ï¼Œç±»å¯ä»¥ä½œä¸ºæ¥å£ï¼Œé€šè¿‡ å…³é”®å­— <code>implements</code>æ¥å®ç°æ¥å£ï¼Œå¯¹åº”çš„ç±»ï¼Œå¿…é¡»å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•ä»¥åŠå±æ€§</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A person. The implicit interface contains greet().</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> _name;</span><br><span class="line">    Person(<span class="keyword">this</span>._name);</span><br><span class="line">    <span class="built_in">String</span> greet(<span class="built_in">String</span> who) =&gt; <span class="string">'Hello, <span class="subst">$who</span>. I am <span class="subst">$_name</span>.'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¿…é¡»å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•å±æ€§</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Impostor</span> <span class="keyword">implements</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">get</span> _name =&gt; <span class="string">''</span>;</span><br><span class="line">    <span class="built_in">String</span> greet(<span class="built_in">String</span> who) =&gt; <span class="string">'Hi <span class="subst">$who</span>. Do you know who I am?'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ extends æ¥æ‰©å±•ç±»ã€‚</p>
</li>
<li>æ”¯æŒé‡è½½æˆå‘˜æ–¹æ³•<code>override</code>ï¼Œä»¥åŠå¯¹æ“ä½œç¬¦çš„é‡è½½</li>
<li>noSuchMethodã€‚å¦‚æœç”¨æˆ·è°ƒç”¨ç±»ä¸­ä¸å­˜åœ¨çš„æˆå‘˜æ–¹æ³•ï¼Œå¯ä»¥ç»™å‡ºæç¤º é‡è½½ <code>noSuchMethod</code><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="meta">@override</span></span><br><span class="line">    <span class="keyword">void</span> noSuchMethod(Invocation invocation) &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'You tried to use a non-existent member: '</span> +</span><br><span class="line">            <span class="string">'<span class="subst">$&#123;invocation.memberName&#125;</span>'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="æšä¸¾ç±»å‹-Enumerated-types-ï¼Œæ¯ä¸ªå€¼-éƒ½æœ‰ä¸€ä¸ªindexå±æ€§ï¼Œä»-0å¼€å§‹è®¡æ•°ã€‚-Color-valuesæ‹¿åˆ°æ‰€æœ‰çš„å€¼ï¼Œå¯ä»¥æŠŠåœ¨switch-caseè¯­å¥é‡Œé¢æŠŠæšä¸¾å½“åšåˆ¤æ–­æ¡ä»¶"><a href="#æšä¸¾ç±»å‹-Enumerated-types-ï¼Œæ¯ä¸ªå€¼-éƒ½æœ‰ä¸€ä¸ªindexå±æ€§ï¼Œä»-0å¼€å§‹è®¡æ•°ã€‚-Color-valuesæ‹¿åˆ°æ‰€æœ‰çš„å€¼ï¼Œå¯ä»¥æŠŠåœ¨switch-caseè¯­å¥é‡Œé¢æŠŠæšä¸¾å½“åšåˆ¤æ–­æ¡ä»¶" class="headerlink" title="æšä¸¾ç±»å‹  Enumerated types ï¼Œæ¯ä¸ªå€¼ éƒ½æœ‰ä¸€ä¸ªindexå±æ€§ï¼Œä» 0å¼€å§‹è®¡æ•°ã€‚ Color.valuesæ‹¿åˆ°æ‰€æœ‰çš„å€¼ï¼Œå¯ä»¥æŠŠåœ¨switch/caseè¯­å¥é‡Œé¢æŠŠæšä¸¾å½“åšåˆ¤æ–­æ¡ä»¶"></a>æšä¸¾ç±»å‹  Enumerated types ï¼Œæ¯ä¸ªå€¼ éƒ½æœ‰ä¸€ä¸ªindexå±æ€§ï¼Œä» 0å¼€å§‹è®¡æ•°ã€‚ <code>Color.values</code>æ‹¿åˆ°æ‰€æœ‰çš„å€¼ï¼Œå¯ä»¥æŠŠåœ¨switch/caseè¯­å¥é‡Œé¢æŠŠæšä¸¾å½“åšåˆ¤æ–­æ¡ä»¶</h5><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Color &#123; red, green, blue &#125;</span><br><span class="line">Color.red.index == <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h4 id="åœ¨æ‰©å±•å¯¹è±¡çš„åŒæ—¶-è¿˜å¯ä»¥ä½¿ç”¨-mixinsåŠŸèƒ½ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½"><a href="#åœ¨æ‰©å±•å¯¹è±¡çš„åŒæ—¶-è¿˜å¯ä»¥ä½¿ç”¨-mixinsåŠŸèƒ½ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½" class="headerlink" title="åœ¨æ‰©å±•å¯¹è±¡çš„åŒæ—¶ è¿˜å¯ä»¥ä½¿ç”¨ mixinsåŠŸèƒ½ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½"></a>åœ¨æ‰©å±•å¯¹è±¡çš„åŒæ—¶ è¿˜å¯ä»¥ä½¿ç”¨ mixinsåŠŸèƒ½ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½</h4><h4 id="æ³›å‹-ç”¨æ³•ä¸å…¶ä»–é«˜çº§è¯­è¨€ä¸­çš„æ³›å‹ä¸€æ ·-å…è®¸ç¨‹åºå‘˜åœ¨å¼ºç±»å‹ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ç¼–å†™ä»£ç æ—¶å®šä¹‰ä¸€äº›å¯å˜çš„ç±»å‹ï¼Œé‚£äº›éƒ¨åˆ†åœ¨ä½¿ç”¨å‰å¿…é¡»ä½œå‡ºæŒ‡æ˜ã€‚Map-Listxxiéƒ½åŸºäºæ³›å‹ï¼Œå…·æœ‰ç›¸ä¼¼åŠŸèƒ½çš„ç±»ï¼Œå¯ä»¥é€šè¿‡æ³›å‹å®ç°ï¼Œæ¥é¿å…ä»£ç çš„é‡å¤ï¼Œæé«˜æŠ½è±¡ç¨‹åº¦ã€‚å¯ä»¥å®šä¹‰æ³›å‹ç±»-ä»¥åŠæ³›å‹çš„æ–¹æ³•"><a href="#æ³›å‹-ç”¨æ³•ä¸å…¶ä»–é«˜çº§è¯­è¨€ä¸­çš„æ³›å‹ä¸€æ ·-å…è®¸ç¨‹åºå‘˜åœ¨å¼ºç±»å‹ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ç¼–å†™ä»£ç æ—¶å®šä¹‰ä¸€äº›å¯å˜çš„ç±»å‹ï¼Œé‚£äº›éƒ¨åˆ†åœ¨ä½¿ç”¨å‰å¿…é¡»ä½œå‡ºæŒ‡æ˜ã€‚Map-Listxxiéƒ½åŸºäºæ³›å‹ï¼Œå…·æœ‰ç›¸ä¼¼åŠŸèƒ½çš„ç±»ï¼Œå¯ä»¥é€šè¿‡æ³›å‹å®ç°ï¼Œæ¥é¿å…ä»£ç çš„é‡å¤ï¼Œæé«˜æŠ½è±¡ç¨‹åº¦ã€‚å¯ä»¥å®šä¹‰æ³›å‹ç±»-ä»¥åŠæ³›å‹çš„æ–¹æ³•" class="headerlink" title="æ³›å‹ ç”¨æ³•ä¸å…¶ä»–é«˜çº§è¯­è¨€ä¸­çš„æ³›å‹ä¸€æ · å…è®¸ç¨‹åºå‘˜åœ¨å¼ºç±»å‹ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ç¼–å†™ä»£ç æ—¶å®šä¹‰ä¸€äº›å¯å˜çš„ç±»å‹ï¼Œé‚£äº›éƒ¨åˆ†åœ¨ä½¿ç”¨å‰å¿…é¡»ä½œå‡ºæŒ‡æ˜ã€‚Map Listxxiéƒ½åŸºäºæ³›å‹ï¼Œå…·æœ‰ç›¸ä¼¼åŠŸèƒ½çš„ç±»ï¼Œå¯ä»¥é€šè¿‡æ³›å‹å®ç°ï¼Œæ¥é¿å…ä»£ç çš„é‡å¤ï¼Œæé«˜æŠ½è±¡ç¨‹åº¦ã€‚å¯ä»¥å®šä¹‰æ³›å‹ç±» ä»¥åŠæ³›å‹çš„æ–¹æ³•"></a>æ³›å‹ ç”¨æ³•ä¸å…¶ä»–é«˜çº§è¯­è¨€ä¸­çš„æ³›å‹ä¸€æ · å…è®¸ç¨‹åºå‘˜åœ¨å¼ºç±»å‹ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ç¼–å†™ä»£ç æ—¶å®šä¹‰ä¸€äº›å¯å˜çš„ç±»å‹ï¼Œé‚£äº›éƒ¨åˆ†åœ¨ä½¿ç”¨å‰å¿…é¡»ä½œå‡ºæŒ‡æ˜ã€‚<code>Map</code> <code>List</code>xxiéƒ½åŸºäºæ³›å‹ï¼Œå…·æœ‰ç›¸ä¼¼åŠŸèƒ½çš„ç±»ï¼Œå¯ä»¥é€šè¿‡æ³›å‹å®ç°ï¼Œæ¥é¿å…ä»£ç çš„é‡å¤ï¼Œæé«˜æŠ½è±¡ç¨‹åº¦ã€‚å¯ä»¥å®šä¹‰æ³›å‹ç±» ä»¥åŠæ³›å‹çš„æ–¹æ³•</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> names = <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt;();</span><br><span class="line">names.addAll([<span class="string">'Seth'</span>, <span class="string">'Kathy'</span>, <span class="string">'Lars'</span>]);</span><br><span class="line">names.add(<span class="number">42</span>); <span class="comment">// Err</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> names = &lt;<span class="built_in">String</span>&gt;[<span class="string">'å¼ ä¸‰'</span>, <span class="string">'æå››'</span>, <span class="string">'ç‹äº”'</span>];</span><br><span class="line"><span class="keyword">var</span> pages = &lt;<span class="built_in">String</span>, <span class="built_in">int</span>&gt;&#123;</span><br><span class="line">    <span class="string">'å¼ ä¸‰'</span>: <span class="number">11</span>,</span><br><span class="line">    <span class="string">'æå››'</span>: <span class="number">12</span>,</span><br><span class="line">    <span class="string">'ç‹äº”'</span>: <span class="number">13</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="æ¨¡å—åŒ–"><a href="#æ¨¡å—åŒ–" class="headerlink" title="æ¨¡å—åŒ–"></a>æ¨¡å—åŒ–</h3><ul>
<li><p>ä½¿ç”¨ <code>import</code> å¯¼å…¥æ¨¡å—</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:lib1/lib1.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:lib2/lib2.dart'</span> <span class="keyword">as</span> lib2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Uses Element from lib1.</span></span><br><span class="line"><span class="built_in">Element</span> element1 = <span class="built_in">Element</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Uses Element from lib2.</span></span><br><span class="line">lib2.<span class="built_in">Element</span> element2 = lib2.<span class="built_in">Element</span>();</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
</li>
<li><p>éƒ¨åˆ†å¯¼å…¥</p>
<figure class="highlight dart"><figcaption><span>åªå¯¼å…¥foo æ¨¡å—</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:lib1/lib1.dart'</span> show foo;</span><br><span class="line"><span class="comment">// å¯¼å…¥ foo ä¹‹å¤–çš„æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:lib2/lib2.dart'</span> hide foo;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‡’åŠ è½½ã€‚åœ¨è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½ç”¨åˆ°çš„æ¨¡å—ï¼Œé€‚ç”¨äºå¦‚ä¸‹åœºæ™¯:</p>
</li>
</ul>
<ol>
<li>å‡å°Appçš„å¯åŠ¨æ—¶é—´</li>
<li>è¿›è¡ŒA/Bæµ‹è¯•ï¼Œå¯é€‰æ‹©çš„ä¸åŒçš„ç®—æ³•å®ç°</li>
<li>ä¸€äº›ä¸å¸¸ç”¨çš„åŠŸèƒ½ï¼Œæ²¡å¿…è¦æ¯æ¬¡éƒ½å¯åŠ¨</li>
</ol>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:greetings/hello.dart'</span> deferred <span class="keyword">as</span> hello;</span><br><span class="line"></span><br><span class="line">Future greet() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> hello.loadLibrary();</span><br><span class="line">    hello.printGreeting();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹å¼ è·ŸES6ä¸­ çš„ åŠ¨æ€åŠ è½½ç±»ä¼¼  å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™æ˜¯JavaScriptçš„ä»£ç </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">import</span>(<span class="string">'./hello'</span>).then(hello) =&gt; &#123;</span><br><span class="line">        hello.printGreeting()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–è€…</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">const</span> hello=<span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">'./hello'</span>)</span><br><span class="line">    hello.printGreeting()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ES 6 ä¸­ import(â€˜./helloâ€™) è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseï¼ŒDartä¸­çš„Future è·ŸES6ä¸­çš„Promiseç±»ä¼¼ï¼ŒåŒæ—¶Dartä¸­ä¹Ÿæœ‰ async/await ä¸ES7ä¸­çš„async/await åŠŸèƒ½ç±»ä¼¼</p>
<h4 id="å¼‚æ­¥æ”¯æŒ-ï¼Œ"><a href="#å¼‚æ­¥æ”¯æŒ-ï¼Œ" class="headerlink" title="å¼‚æ­¥æ”¯æŒ ï¼Œ"></a>å¼‚æ­¥æ”¯æŒ ï¼Œ</h4><p>å¯¹äºå¼‚æ­¥çš„å¤„ç†ä¸ ESä¸­çš„ç±»ä¼¼</p>
<ul>
<li>async/await</li>
<li><a href="https://api.dartlang.org/stable/2.1.0/dart-async/Future-class.html" target="_blank" rel="noopener">Future (promise)</a> </li>
<li>å»ºè®®async/awaité…åˆtry/catchä½¿ç”¨</li>
</ul>
<p>å¦å¤–æä¸€ä¸‹  <code>Future.delayed</code> å¯ä»¥å¼‚æ­¥å»¶æ—¶æ‰§è¡Œä»£ç ï¼Œä¸æ”¯æŒå–æ¶ˆ, æˆ‘ä»¬<code>Timer</code> æ¥å®ç°  JavaScript <code>setTimeout</code>æ“ä½œï¼Œæ”¯æŒå–æ¶ˆ</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Future.delayed(<span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">10</span>), ()=&gt;<span class="built_in">print</span>(<span class="string">'hello world'</span>));</span><br></pre></td></tr></table></figure>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">        Timer(<span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">10</span>), ()=&gt;<span class="built_in">print</span>(<span class="string">'hello world'</span>));</span><br><span class="line">        Timer timer= Timer(<span class="keyword">const</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">10</span>), ()=&gt;<span class="built_in">print</span>(<span class="string">'0'</span>));</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'1'</span>);</span><br><span class="line">        timer.cancel(); <span class="comment">//è¾“å‡ºç»“æœ  1   hello world</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="httpè¯·æ±‚-ä½¿ç”¨-dart-io-ä¸­çš„-HttpClient"><a href="#httpè¯·æ±‚-ä½¿ç”¨-dart-io-ä¸­çš„-HttpClient" class="headerlink" title="httpè¯·æ±‚ ä½¿ç”¨ dart:io ä¸­çš„ HttpClient"></a>httpè¯·æ±‚ ä½¿ç”¨ <code>dart:io</code> ä¸­çš„ <a href="https://docs.flutter.io/flutter/dart-io/HttpClient-class.html" target="_blank" rel="noopener">HttpClient</a></h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:io'</span></span><br><span class="line">HttpClient client = <span class="keyword">new</span> HttpClient();</span><br><span class="line">client.getUrl(<span class="built_in">Uri</span>.parse(<span class="string">"http://www.example.com/"</span>))</span><br><span class="line">    .then((HttpClientRequest request) &#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">    <span class="keyword">return</span> request.close();</span><br><span class="line">    &#125;)</span><br><span class="line">    .then((HttpClientResponse response) &#123;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Generators-åŒ…å«å¼‚æ­¥-åŒæ­¥ä¸¤ç§generator-ã€ä¸ES6ä¸­çš„ç±»ä¼¼"><a href="#Generators-åŒ…å«å¼‚æ­¥-åŒæ­¥ä¸¤ç§generator-ã€ä¸ES6ä¸­çš„ç±»ä¼¼" class="headerlink" title="Generators:  åŒ…å«å¼‚æ­¥/åŒæ­¥ä¸¤ç§generator ã€ä¸ES6ä¸­çš„ç±»ä¼¼"></a>Generators:  åŒ…å«å¼‚æ­¥/åŒæ­¥ä¸¤ç§generator ã€ä¸ES6ä¸­çš„ç±»ä¼¼</h4><h4 id="typedef-è‡ªå®šä¹‰æ–°çš„ç±»å‹-ä¸Cä¸­çš„typedefç±»ä¼¼"><a href="#typedef-è‡ªå®šä¹‰æ–°çš„ç±»å‹-ä¸Cä¸­çš„typedefç±»ä¼¼" class="headerlink" title="typedef: è‡ªå®šä¹‰æ–°çš„ç±»å‹,ä¸Cä¸­çš„typedefç±»ä¼¼"></a>typedef: è‡ªå®šä¹‰æ–°çš„ç±»å‹,ä¸Cä¸­çš„typedefç±»ä¼¼</h4><h4 id="Dartæ”¯æŒæ³¨è§£ç¼–ç¨‹"><a href="#Dartæ”¯æŒæ³¨è§£ç¼–ç¨‹" class="headerlink" title="Dartæ”¯æŒæ³¨è§£ç¼–ç¨‹"></a>Dartæ”¯æŒæ³¨è§£ç¼–ç¨‹</h4><p>æ³¨è§£ç”¨ä¸Javaä¸­çš„æ³¨è§£ æˆ–è€…ES6ä¸­çš„ Decoratorç±»ä¼¼ï¼Œå†…ç½®äº†ä¸¤ä¸ªæ³¨è§£ <code>@deprecated</code> <code>@override</code>. </p>
<h4 id="isolate-éš”ç¦»çš„ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¸åŒçš„isolateæ— æ³•å…±äº«å†…å­˜"><a href="#isolate-éš”ç¦»çš„ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¸åŒçš„isolateæ— æ³•å…±äº«å†…å­˜" class="headerlink" title="isolate: éš”ç¦»çš„ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¸åŒçš„isolateæ— æ³•å…±äº«å†…å­˜"></a>isolate: éš”ç¦»çš„ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¸åŒçš„isolateæ— æ³•å…±äº«å†…å­˜</h4><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å­¦ä¹ äº†Dartçš„åŸºç¡€è¯­æ³•ï¼Œæ„Ÿè§‰å¦‚æœæœ‰å…¶ä»–çš„ç¼–ç¨‹è¯­è¨€çš„è¯å­¦èµ·æ¥ è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ï¼Œã€‚Dartæ˜¯ä¸€ç§å¼ºç±»å‹çš„è¯­è¨€ï¼Œé‡Œé¢ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ã€‚Objectæ˜¯ä»»ä½•å¯¹è±¡çš„åŸºç±»ã€‚æ”¯æŒç±»å‹æ¨æ–­ã€æ”¯æŒæ³›å‹ï¼Œè®©ä»£ç èƒ½å‡è½»ä¸å°‘ï¼Œæ”¯æŒæ¥å£ç¼–ç¨‹ã€æ³¨è§£ç¼–ç¨‹ã€Mixinã€‚æ”¯æŒæ¨¡å—çš„æŒ‰éœ€åŠ è½½ã€‚isolateæä¾›äº†åŸºäºevent-loopå•çº¿ç¨‹æ¨¡å‹ï¼Œå¼‚æ­¥æ“ä½œæ”¯æŒFutureã€async/awaitæ¥å†™å‡ºåŒæ­¥åŒ–çš„ä»£ç ã€‚Dartæ”¯æŒAOTå’ŒJITä¸¤ç§ç¼–è¯‘æ–¹å¼ï¼Œä¿è¯äº†è¾ƒå¥½çš„å¼€å‘ä½“éªŒï¼Œä»¥åŠè¾ƒé«˜æ€§èƒ½çš„çº¿ä¸Šæ¨¡å¼ã€‚åŸºæœ¬ä¸ŠæŒæ¡äº†è¿™äº›å¯ä»¥ä¸Šæ‰‹æ’¸Flutteräº†ï¼ŒDartæ·±å…¥æ–‡æ¡£æŸ¥çœ‹<a href="https://www.dartlang.org/guides/libraries/library-tour" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>,æœ‰äº›APIå¯èƒ½è®°ä¸ä½çš„è¯å¯ä»¥å»<a href="https://api.dartlang.org/stable/2.1.0/index.html" target="_blank" rel="noopener">APIæ–‡æ¡£</a>æŸ¥çœ‹ã€‚Dart åŒ…åŸºäºPubç®¡ç†çš„ï¼Œç±»ä¼¼NodeJSä¸­çš„NPMéœ€è¦ä»€ä¹ˆåŠŸèƒ½å¯ä»¥å»Pubä¸Šå»æœ <a href="https://pub.dartlang.org/" target="_blank" rel="noopener">https://pub.dartlang.org/</a></p>
<p>æ„é€ å¯¹è±¡å¯ä»¥ä¸å†™newï¼Œè¯­å¥ç»“å°¾è®°å¾—åŠ åˆ†å·;;;;</p>

        

      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/Dart/">
                #Dart
              </a>
            
          </div>
        

        

        
          <div class="post-eof the-shape"></div>
        
      </div>
    
  </div>


  
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/11/24/webcompiler-babel/">
                å‰ç«¯ç¼–è¯‘æŠ€æœ¯ï¼šBabel
              </a>
            
          
        </h1>
      

      <div class="post-meta">
          <span class="post-time">
            
              å‘è¡¨äº 2018-11-24
            
          </span>
        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2018/11/24/webcompiler-babel/#comments">
              <span class="post-comments-count ds-thread-count" data-thread-key="2018/11/24/webcompiler-babel/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <h1 id="å‰ç«¯ç¼–è¯‘æŠ€æœ¯ï¼šBabel"><a href="#å‰ç«¯ç¼–è¯‘æŠ€æœ¯ï¼šBabel" class="headerlink" title="å‰ç«¯ç¼–è¯‘æŠ€æœ¯ï¼šBabel"></a>å‰ç«¯ç¼–è¯‘æŠ€æœ¯ï¼šBabel</h1><p><a href="http://kunkun12.com/blog/ppt/#/">æŠ€æœ¯åˆ†äº«PPT</a><br>(æœ¬æ–‡å™è¿°çš„å†…å®¹æ‰€æ¶‰åŠåˆ°çš„ç›¸å…³ç‰¹æ€§ä»¥Babel V7ä¸ºå‡†)</p>
<h3 id="Compiler-or-Transpiler"><a href="#Compiler-or-Transpiler" class="headerlink" title="Compiler or Transpiler?"></a>Compiler or Transpiler?</h3><p>Babel :åŸå6to5 2014.9å‘å¸ƒç¬¬ä¸€ä¸ªç‰ˆæœ¬, 2015.2æ›´åä¸ºbabel,å‰æœŸç”±Sebastian McKenzie ç ”å‘ï¼Œç›®å‰ç”±å›¢é˜Ÿæ¥ä¸ºç»´æŠ¤ï¼Œæ ¸å¿ƒå¼€å‘è€…é‡Œé¢è¿˜æœ‰æ˜¯TC39çš„æˆå‘˜ï¼ŒBabelå–åçµæ„Ÿæ¥è‡ªäº<a href="https://en.wikipedia.org/wiki/List_of_races_and_species_in_The_Hitchhiker%27s_Guide_to_the_Galaxy#Babel_fish" target="_blank" rel="noopener">BabelFish</a> æ˜¯ä¸€ç§è™šæ‹Ÿå‡ºæ¥çš„é±¼,å¯ä»¥ç¿»è¯‘ä»»ä½•ç‰©ç§çš„è¯­è¨€ï¼ŒBabelä¹Ÿä¸è´Ÿç››åï¼Œæˆäº†ç›®å‰æœ€çŸ¥åçš„JavaScriptè¯­æ³•â€œç¼–è¯‘å™¨â€ã€ä¸€ç§æºç è½¬è¯‘æºç åˆ°ç¼–è¯‘å™¨(source-to-source)ã€‚å®˜æ–¹è¯´æ˜¯<a href="https://zh.wikipedia.org/wiki/%E7%B7%A8%E8%AD%AF%E5%99%A8" target="_blank" rel="noopener">compiler</a>ã€ä¹Ÿæœ‰äººç§°ä¹‹ä¸ºtranspiler(è½¬è¯‘å™¨)ï¼Œstackoverflowä¹Ÿæœ‰äººæé—®<a href="https://stackoverflow.com/questions/43968748/is-babel-a-compiler-or-transpiler" target="_blank" rel="noopener">Is Babel a compiler or transpiler?</a>ã€‚æ€»ç»“ä¸€ä¸‹å¤§è‡´æ„æ€ï¼Œç¼–è¯‘å™¨æ˜¯å°†ä¸€ç§è¯­è¨€è½¬ä¸ºå¦ä¸€ç§ç›¸å¯¹ä½çº§ä¸€äº›çš„è¯­è¨€ï¼ˆæ¯”å¦‚ Javaåˆ°å­—èŠ‚ç ã€‚Cåˆ°äºŒè¿›åˆ¶)ã€‚ è½¬ç§»å™¨æ˜¯å°†ä¸€ç§è¯­è¨€è½¬ä¸ºå¦ä¸€ç§åŒç­‰çº§åˆ«çš„ä»£ç (æ¯”å¦‚JavaScript to python),é‚£ä¹ˆES6 åˆ° ES5 ç®—åŒä¸€ä¸ªlevelçš„è½¬æ¢å—ï¼Ÿï¼Ÿè‡ªè¡Œç†è§£å§ã€‚<br>å¯¹æˆ‘ä»¬æ¥è¯´Babelæ˜¯JavaScriptè¯­æ³•è½¬æ¢å·¥å…·æˆ–æ˜¯ç¿»è¯‘å·¥å…·,å› æ­¤ä¸å¿…å¤ªçº ç»“compilerè¿˜æ˜¯transpiler ã€‚é™¤äº†èƒ½å¤Ÿè½¬æ¢æ ‡å‡†ESä»¥åŠè‰æ¡ˆä¹‹å¤–ï¼Œå®ƒè¿˜æ”¯æŒJSXã€typescriptã€flowã€‚ å¦å¤–babelæ–¹ä¾¿çµæ´»çš„æ’ä»¶æ‰©å±•æœºåˆ¶ï¼Œä¼—å¤šçš„å¼€å‘è€…ä¹Ÿç›¸ç»§å¼€å‘å‡ºè®¸å¤šbabelæ’ä»¶ï¼Œè®©babelä¸å†åªæ˜¯ä½œä¸ºä¸€ä¸ªå·¥å…· æ›´æ˜¯ä¸€ä¸ªå¹³å°ã€‚</p>
<h3 id="Babelçš„ç»„æˆ"><a href="#Babelçš„ç»„æˆ" class="headerlink" title="Babelçš„ç»„æˆ"></a>Babelçš„ç»„æˆ</h3><p> Babelæ˜¯ä¸€ä¸ªç»„åˆå¥—è£…ï¼Œæ‹†åˆ†ä¸ºå‡ åä¸ªåŒ…ï¼Œå‡åœ¨<code>@babel</code>å‘½åç©ºé—´ä¸‹</p>
<h4 id="æ ¸å¿ƒéƒ¨ä»¶"><a href="#æ ¸å¿ƒéƒ¨ä»¶" class="headerlink" title="æ ¸å¿ƒéƒ¨ä»¶"></a>æ ¸å¿ƒéƒ¨ä»¶</h4><ul>
<li>@babel/parser (åŸåBabylon) åŸºäº <a href="https://github.com/acornjs/acorn" target="_blank" rel="noopener">acorn</a> and <a href="https://github.com/RReverser/acorn-jsx" target="_blank" rel="noopener">acorn-jsx</a>ã€‚ç”¨äºè¯­æ³•è§£æ</li>
<li>@babel/traverse éå†ASTã€è°ƒç”¨Pluginè½¬æ¢ä»£ç </li>
<li>@babel/generator  å°†è½¬æ¢åçš„ASTç”Ÿæˆä»£ç </li>
<li>@babel/core  è½¬æ¢æµç¨‹æ§åˆ¶å™¨ï¼Œæ•´åˆ parserã€traverse plugin generator å®Œæˆè¯­æ³•è½¬æ¢ã€‚</li>
<li>ä¸€å †plugin+5ä¸ªpreset</li>
</ul>
<p>babelçš„ç¼–è¯‘æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>Parse è¯æ³•åˆ†æå¾—åˆ° Tokensï¼ŒæŠŠJSä»£ç è§£æä¸º <a href="https://zh.wikipedia.org/wiki/%E6%8A%BD%E8%B1%A1%E8%AA%9E%E6%B3%95%E6%A8%B9" target="_blank" rel="noopener">æŠ½è±¡è¯­æ³•æ ‘ï¼ˆAST)</a></li>
<li>Transform éå†è¯­æ³•æ ‘ï¼Œé€šè¿‡Babel-pluginæ“ä½œ ASTï¼Œæ”¹å˜è¯­æ³•æ ‘ã€‚</li>
<li>Generate Code æ–°çš„è¯­æ³•æ ‘ç”Ÿæˆä»£ç ã€‚</li>
</ol>
<p>æ€»ç»“ ï¼šè¾“å…¥å­—ç¬¦ä¸² -&gt; @babel/parser parser -&gt; AST -&gt; traverse -&gt;@babe/pluginâ€“xxxx-&gt; AST -&gt; @babel/generator -&gt; è¾“å‡ºå­—ç¬¦ä¸²</p>
<h4 id="è¾…åŠ©åŒ…"><a href="#è¾…åŠ©åŒ…" class="headerlink" title="è¾…åŠ©åŒ…"></a>è¾…åŠ©åŒ…</h4><ul>
<li><code>@babel/types</code> ã€<code>@babel/template</code> ã€<code>@babel/helpers</code>ã€<code>@</code>babel/code-frames`  æ–¹ä¾¿æ“ä½œè¯­æ³•æ ‘ã€æä¾›çš„å·¥å…·ç±»ï¼Œå†™æ’ä»¶çš„æ—¶å€™ä¼šç”¨åˆ°</li>
<li><code>@babel/polyfill</code>ã€‚ESæ ‡å‡†ä¸­åŒ…æ‹¬ä¸¤éƒ¨åˆ†: æ–°å¢çš„è¯­æ³•+æ–°å¢çš„APIã€‚ Babelç¼–è¯‘æµç¨‹åªæä¾›äº†è¯­æ³•çš„è½¬æ¢(æ¯”å¦‚constã€letã€asyncã€awaitã€ç®­å¤´å‡½æ•°ç­‰ï¼‰ï¼Œ babel/polyfillæ˜¯ESæ ‡å‡†æ–°å¢çš„åŸç”Ÿå¯¹è±¡ä»¥åŠAPIçš„æ¨¡æ‹Ÿå®ç°ï¼ˆæ¯”å¦‚<code>Promise</code>ã€<code>Map</code>ã€<code>Set</code>ã€<code>Object.assign</code>ã€<code>Array.from</code>ã€<code>Object.assig</code>ç­‰ï¼‰ï¼Œå…¶å®<code>@babel/polyfill</code>ä¸Šä»…ä»…æ˜¯<code>core-j</code>så’Œ<code>regenerator-runtime</code>ä¸¤ä¸ªåŒ…çš„<a href="https://github.com/babel/babel/blob/master/packages/babel-polyfill/src/index.js" target="_blank" rel="noopener">ç®€å•å°è£…</a>ï¼Œä¹‹å‰ç‰ˆæœ¬ä¸­æˆ‘ä»¬éƒ½æ˜¯åœ¨æ–‡ä»¶çš„æ”¶å£å¤„æ‰‹åŠ¨çš„å¼•å…¥<code>babel polyfill</code>ã€‚æ•´ä¸ªPolyFillæ–‡ä»¶è¾ƒå¤§ã€æ²¡å¿…è¦å…¨éƒ¨å¯¼å…¥ã€ä¹Ÿæ²¡å¿…è¦æ‰‹åŠ¨å¯¼å…¥ã€åœ¨babel V7ä¹‹åæ¨èæ–°çš„ä½¿ç”¨æ–¹æ³•ã€‚é€šè¿‡é…ç½® envé€‰é¡¹çš„æ—¶å€™æ·»åŠ  <code>&quot;useBuiltIns&quot;:&quot;usage&quot;</code>,ä¼šè‡ªåŠ¨åˆ†æä»£ç æ ¹æ®éœ€æ±‚æ¥æŒ‰éœ€é’ˆå¯¹æ€§çš„å¯¼å…¥polyfillã€‚å¦å¤–polyfillæ˜¯å…¨å±€å¯¼å…¥çš„ï¼Œåƒ<code>Array.prototype.includes</code>è¿˜ä¼šä¿®æ”¹åŸç”Ÿå‡½æ•°çš„åŸå‹ã€‚polyfillåªåŒ…å«äº†è¶…è¿‡<code>stage4</code>ä»¥ä¸Šçš„è§„èŒƒã€‚å¦‚æœè¦ä½¿ç”¨æ›´ä½çº§è‰æ¡ˆæ ‡å‡†çš„API éœ€è¦è‡ªå·±æ‰‹åŠ¨å»å¼•å…¥<a href="https://github.com/zloirock/core-js" target="_blank" rel="noopener">core-js</a>é‡Œé¢çš„å‡½æ•°ã€‚ä¸¾ä¸ªä¾‹å­ .babelrcé…ç½®æ–‡ä»¶å¦‚ä¸‹<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [[<span class="string">"@babel/env"</span>, &#123;</span><br><span class="line">        <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span></span><br><span class="line">    &#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>æºç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'   foo  '</span>;</span><br><span class="line">str.trimLeft();</span><br><span class="line">str.padStart(<span class="number">10</span>);</span><br></pre></td></tr></table></figure></p>
<p>babel ç¼–è¯‘è¾“å‡ºç»“æœ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">"core-js/modules/es7.string.pad-start"</span>);</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'   foo  '</span>;</span><br><span class="line">str.trimLeft();</span><br><span class="line">str.padStart(<span class="number">10</span>);</span><br></pre></td></tr></table></figure></p>
<p><code>String.prototype.padStart</code> æ˜¯ ES(7) æ­£å¼ç‰ˆçš„è§„èŒƒï¼Œå› æ­¤ä¼šè‡ªåŠ¨å¼•å…¥pad-startçš„polyfillã€è€Œ <a href="https://github.com/tc39/proposal-string-left-right-trim" target="_blank" rel="noopener"><code>trimLeft</code></a>æˆªæ­¢ç›®å‰è¿˜åœ¨ <code>Stage 3</code>ã€‚éœ€è¦è‡ªå·±æ‰‹åŠ¨å¼•å…¥<code>core-js(-pure)/features/string/trim-left</code>ã€‚</p>
<p>è¿™é‡Œæä¸€ä¸‹ï¼Œå¯¹äºæ¯ä¸€é¡¹æ–°ç‰¹æ€§ï¼Œè¦æœ€ç»ˆçº³å…¥ECMAScriptè§„èŒƒä¸­ï¼ŒTC39(æŒ‡å®šESæ ‡å‡†çš„ç»„ç»‡)æ‹Ÿå®šäº†ä¸€ä¸ªå¤„ç†è¿‡ç¨‹ï¼Œç§°ä¸º<a href="https://tc39.github.io/process-document/" target="_blank" rel="noopener">TC39 process</a>ã€å…¶ä¸­å…±åŒ…å«5ä¸ªé˜¶æ®µ:</p>
<pre><code>stage-0: (ç¨»è‰äºº)åªæ˜¯ä¸€ä¸ªæƒ³æ³•
stage-1: (ææ¡ˆ)åˆæ­¥å°è¯•
stage-2: (è‰ç¨¿)åˆæ­¥è§„èŒƒ
stage-3: (å€™é€‰)å®Œæˆè§„èŒƒå’Œæµè§ˆå™¨åˆæ­¥å®ç°
stage-4: (å®šç¨¿)ä»£å‘ç‰ˆ
</code></pre><p>æ—¢ç„¶è¯´åˆ°polyfilläº† è¿˜å¾—è¯´ä¸€ä¸ªå‡½æ•° :<code>regeneratorruntime</code>, è¿™ä¸ªå‡½æ•°ä¹Ÿè¢«ç®—åœ¨äº†babel-polyfillé‡Œé¢äº†ï¼Œå®ƒä¸æ˜¯ESè§„èŒƒæ–°å¢çš„APIï¼Œåªæ˜¯babelåœ¨åšasync/await è¯­æ³•è½¬æ¢çš„æ—¶å€™ï¼Œè½¬æ¢åçš„ç»“æœä»£ç è°ƒç”¨åˆ°äº†è¿™ä¸ªå‡½æ•°ï¼Œè½¬æ¢ç»“æœå¹¶æ²¡æœ‰æä¾›è¿™ä¸ªå‡½æ•°çš„å®šä¹‰ï¼Œæ‰€ä»¥è¦è®©ä»£ç èƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼Œå¿…é¡»è¦å¼•å…¥<code>regeneratorruntime</code>è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœé…ç½®babelçš„æ—¶å€™ envé‡Œé¢è®¾ç½® <code>&quot;useBuiltIns&quot;: &quot;usage&quot;</code>å±æ€§ï¼Œä¸šåŠ¡é‡Œé¢å¦‚æœç”¨åˆ°async/await ä¼šè‡ªåŠ¨å¼•å…¥regeneratorruntimeè¿™ä¸ªpolyfill</p>
<ul>
<li>@babel/runtimeï¼šåŠŸèƒ½ç±»ä¼¼babel-polyfillï¼Œæä¾›äº†ä¸€äº›å¸®åŠ©å‡½æ•°(regeneratorruntimeã€_classCallCheck ç­‰ä¸€äº›è½¬æ¢åçš„ä»£ç  é‡Œé¢ç”¨åˆ°çš„ä¸€äº›å‡½æ•°)ä»¥åŠéå®ä¾‹æ–¹æ³•ï¼ˆArray.from,Object.assignã€Promiseã€Mapç­‰)çš„shimï¼Œä¸€èˆ¬ç”¨äºlibraryæˆ–pluginä¸­ï¼Œæœ€å¤§å¥½å¤„å‡å°‘å·¥å…·ä»£ç é‡å¤å¼•ç”¨ã€ä¸”ä¸ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸï¼Œé…åˆ<a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-runtime" target="_blank" rel="noopener">babel/plugin-transform-runtime</a>æ’ä»¶ä½¿ç”¨ æ›´å¤šä¿¡æ¯å¯ä»¥å‚è€ƒ<a href="https://segmentfault.com/q/1010000005596587" target="_blank" rel="noopener">babel-polyfill å’Œ runtimeçš„åŒºåˆ«</a></li>
</ul>
<h4 id="å…¶ä»–å·¥å…·"><a href="#å…¶ä»–å·¥å…·" class="headerlink" title="å…¶ä»–å·¥å…·"></a>å…¶ä»–å·¥å…·</h4><ul>
<li>@babel/cli babelå‘½ä»¤è¡Œå·¥å…·</li>
<li>@babel/node nodeJSç¯å¢ƒä¸‹ä½¿ç”¨babelçš„åŠŸèƒ½ï¼Œç”±äºæ€§èƒ½é—®é¢˜ä¸å¾—åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨</li>
<li>@babel/register é€šè¿‡ç»‘å®šnode.jsçš„requireæ¥è‡ªåŠ¨è½¬è¯‘requireå¼•ç”¨çš„jsä»£ç æ–‡ä»¶</li>
<li><a href="https://babeljs.io/repl" target="_blank" rel="noopener">REPL</a> åœ¨çº¿ä½“éªŒå·¥å…·</li>
</ul>
<h3 id="Babel-Plugin"><a href="#Babel-Plugin" class="headerlink" title="Babel Plugin"></a>Babel Plugin</h3><p>ä¸Šé¢å·²ç»ä»‹ç»è¿‡babelè¯­æ³•è½¬æ¢æµç¨‹ä¸»è¦åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼šè¯æ³•åˆ†æè¯­æ³•åˆ†æç”ŸæˆAST-&gt;Pluginæ“ä½œAST-&gt;ç”Ÿæˆä»£ç </p>
<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯ASTï¼ŸAST å³æŠ½è±¡è¯­æ³•æ ‘ å®ƒæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤º(ç±»ä¼¼æµè§ˆå™¨é¡µé¢ç”¨æŠ½è±¡ä¸ºDOMæ ‘æ¥è¡¨ç¤º)ã€æ–¹ä¾¿å¯¹ç¼–ç¨‹è¯­è¨€è¿›è¡Œè¯­æ³•åˆ†æã€è¯­æ³•æ£€æŸ¥ã€ä»£ç é£æ ¼æ£€æŸ¥ã€è¯­æ³•è½¬æ¢ã€ä»£ ç ä¼˜åŒ–ç­‰ï¼ŒUglifyJSã€ESLintã€JSDocã€Babelç­‰å¸¸ç”¨çš„å·¥å…·ï¼Œè¿™èƒŒåçš„å°±æ˜¯å¯¹ASTçš„åº”ç”¨ï¼Œå¦å¤–åƒç›®å‰çš„mpvueã€taro ä¹Ÿéƒ½ç”¨åˆ°ASTè½¬æ¢çš„æ€æƒ³ã€‚babelé€šè¿‡è¯­æ³•åˆ†æï¼ŒæŠŠä»£ç è§£æä¸º<a href="https://github.com/babel/babel/blob/master/packages/babel-parser/ast/spec.md" target="_blank" rel="noopener">AST</a>,è¿™æ˜¯åŸºäº<a href="https://github.com/estree/estree" target="_blank" rel="noopener">ESTree</a>ç¨å¾®æ”¹é€ çš„ç»“æ„ï¼ˆEStreeå¯ä»¥è®¤ä¸ºæ˜¯ä¸€äº›æƒå¨å¤§ä½¬è”åˆåˆ¶å®šçš„æ ‡å‡†ï¼‰ã€‚JavaScriptä»£ç çš„è¯­æ³•æ ‘å¯ä»¥é€šè¿‡<a href="https://astexplorer.net" target="_blank" rel="noopener">astexplorer</a>ä¸­æŸ¥çœ‹ã€‚å¯ä»¥æŠŠASTç±»æ¯”DOM Treeï¼Œé‚£ä¹ˆBabelç›¸å½“äºæ“ä½œASTçš„jQuery</p>
<p>Babelè¯­æ³•è½¬æ¢çš„æœ¬è´¨æ˜¯:å°†æºä»£ç è§£æä¸ºASTåã€å¯¹ASTè¿›è¡Œéå†ï¼ˆå…ˆåºæ·±åº¦ä¼˜å…ˆéå†ï¼‰ï¼Œå¹¶å¯¹èŠ‚ç‚¹è¿›è¡Œæ“ä½œï¼ˆå¢ã€åˆ ã€æ”¹ï¼Œæœ€åå°†ASTç”Ÿæˆä»£ç çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ“ä½œè¿‡ç¨‹é‡‡ç”¨çš„æ˜¯Visitors æ¨¡å¼å¯¹èŠ‚ç‚¹è¿›è¡Œè®¿é—®ï¼Œæ¯ä¸€ä¸ªvisitoråœ¨babelé‡Œé¢æœ‰babel-pluginæ‰¿æ‹…ã€‚babel-coreè´Ÿè´£è§£æè¯­æ³•ï¼Œæ¯ä¸€ä¸ªè¯­æ³•çš„è½¬æ¢éœ€è¦ä¸€ä¸ªå•ç‹¬çš„pluginæ¥å˜æ›´ASTï¼Œè½¬æ¢åçš„ASTç”Ÿæˆä»£ç ä¹Ÿç”±babelè‡ªåŠ¨å®Œæˆã€‚babelå®˜æ–¹åŒ…å†…ç½®äº†ä¸€äº›<a href="https://babeljs.io/docs/en/plugins/" target="_blank" rel="noopener">ä¸°å¯Œçš„plugin</a>æ¥å®Œæˆè¯­æ³•çš„è½¬è¯‘(æ¯”å¦‚æœ€æ–°çš„ESæ ‡å‡†/è‰æ¡ˆã€JSXã€typescriptã€flow),ä¸€ä¸ªæ’ä»¶åªå®Œæˆä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½ï¼Œå¯ç”¨è¯¥åŠŸèƒ½éœ€è¦åœ¨babelçš„é…ç½®æ–‡ä»¶é‡Œé¢æ·»åŠ å³å¯ï¼Œä¸ºäº†æ–¹ä¾¿åˆ†äº«ï¼Œä¹Ÿæ–¹ä¾¿é›†ä¸­é…ç½®ï¼ŒæŠŠæ’ä»¶çš„åˆ—è¡¨å°è£…ä¸ºpresetï¼Œpresetå³æ˜¯ä¸€å †æ’ä»¶çš„ç»„åˆåˆã€‚babelçš„æ’ä»¶å¯ç”¨éœ€è¦å•ç‹¬é…ç½®ï¼Œæ”¯æŒå¤šç§é…ç½®æ–¹å¼ ä½¿ç”¨ <code>babel.config.js</code> <code>.babelrc</code> <code>.babelrc.js</code> æˆ–è€…package.jsonä¸­æ·»åŠ  babelçš„å±æ€§.<a href="https://babeljs.io/docs/en/config-files" target="_blank" rel="noopener">å®˜æ–¹ä¹Ÿæœ‰è¯¦ç»†çš„ä»‹ç»</a>ã€‚</p>
<h3 id="Pluginé…ç½®"><a href="#Pluginé…ç½®" class="headerlink" title="Pluginé…ç½®"></a>Pluginé…ç½®</h3><p>ï¼ˆ<a href="https://babeljs.io/docs/en/config-files" target="_blank" rel="noopener">å®˜ç½‘å†™çš„å¾ˆæ¸…æ¥š</a>ï¼Œæ„Ÿè§‰æ²¡å¿…è¦å¤šå†™ï¼‰ç®€å•æä¸€ä¸‹ï¼ŒPresetæ˜¯pluginç»„åˆï¼Œç¿»è¯‘è¿‡æ¥å«â€é¢„è®¾â€ï¼Œå®˜ç½‘çš„æä¾›çš„ä¸€äº›é¢„è®¾ï¼ˆenvã€flowã€reactã€typescriptï¼‰æˆ‘ä»¬ä¹Ÿèƒ½å¾ˆå®¹æ˜“çš„åˆ›é€ è‡ªå·±çš„é¢„è®¾ï¼Œæ¯”å¦‚create-react-app ï¼Œreact-nativeéƒ½æ˜¯è‡ªå®šä¹‰äº†presetï¼Œpresetå¯ä»¥æœ‰é¢„è®¾å’Œpluginç»„æˆã€‚è‡ªå®šä¹‰é¢„è®¾ä¹Ÿè·Ÿé…ç½® babel.config.jsç±»ä¼¼ã€‚å¦å¤–babelåœ¨æ‰§è¡Œçš„æ—¶å€™<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">    presets: [</span><br><span class="line">        <span class="built_in">require</span>(<span class="string">"@babel/preset-env"</span>),</span><br><span class="line">    ],</span><br><span class="line">    plugins: [</span><br><span class="line">        [<span class="built_in">require</span>(<span class="string">"@babel/plugin-proposal-class-properties"</span>), &#123; <span class="attr">loose</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">        <span class="built_in">require</span>(<span class="string">"@babel/plugin-proposal-object-rest-spread"</span>),</span><br><span class="line">    ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>babel7ä¹‹åæ¨èä½¿ç”¨<a href="https://babeljs.io/docs/en/babel-preset-env" target="_blank" rel="noopener">@babel/preset-env</a>æ¥è½¬æ¢æ­£å¼ç‰ˆESè¯­æ³•ï¼Œç›®å‰preset-env===ES3+ES5+ES2015+ES2016+ES2017ï¼Œè¿˜æœ‰ä¸‰ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„presetï¼ˆ typescript flow reactï¼‰,ä¹‹å‰çš„stage0~stage3å››ä¸ªpreset åœ¨Babel 7ä¸­å·²ç»è¢«å¹²æ‰äº†ã€‚å¯¹äºç›®å‰å¤„äºè‰æ¡ˆçš„è¯­æ³•éœ€è¦æ‰‹åŠ¨æ·»åŠ ç›¸å…³pluginã€‚å…·ä½“åˆ°ç‰¹å®šçš„è¯­æ³•æ˜¯å¦ä¸ºè‰æ¡ˆè¿˜æ˜¯æ­£å¼æ ‡å‡†å¯ä»¥å»<a href="https://babeljs.io/docs/en/plugins" target="_blank" rel="noopener">babelçš„æ’ä»¶åˆ—è¡¨</a>çœ‹ä¸€ä¸‹ï¼Œä¸è¦è¢«è¿™ä¹ˆå¤šæ’ä»¶å“åˆ°ï¼Œå…¶å®ä¹Ÿæ²¡å¤šå°‘ï¼Œä¸å¿…ç†ŸçŸ¥ï¼Œå°½é‡éƒ½è¦æ¸…æ¥šæ¯ä¸ªæ’ä»¶çš„ä½œç”¨ã€‚å¦å¤–babel-preset-env è¿˜æ”¯æŒæ ¹æ®æŒ‡å®šä»£ç çš„ç¯å¢ƒå¯¹è¯­æ³•çš„æ”¯æŒç¨‹åº¦ï¼Œæ¥è¿‡æ»¤è¯­æ³•è½¬æ¢ï¼Œç”¨æ¥è¡¨ç¤ºæ¥æ”¯æŒåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Œæ¯”å¦‚<a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener">æµè§ˆå™¨ç‰ˆæœ¬</a>ï¼ŒNodeç‰ˆæœ¬ï¼Œé€šè¿‡è¿™æ ·ç­‰å‡å°‘ä¸€äº›ä¸å¿…è¦çš„è½¬æ¢ï¼Œé™ä½å†—ä½™ä»£ç </p>
<p>å…³äºpluginå’Œpresetæ‰§è¡Œé¡ºåºï¼ŒBabeléå†åˆ°æ¯ä¸ªASTèŠ‚ç‚¹çš„æ—¶å€™ï¼ŒæŒ‰è§„åˆ™æ¥æ‰§è¡Œpluginå’Œpresetã€‚æ‰§è¡Œè§„åˆ™å°±æ˜¯ :å…ˆæ‰§é¡ºåºè¡Œå®Œæ‰€æœ‰Pluginï¼Œå†é€†åºæ‰§è¡ŒPresetã€‚è¿™ä¸ªé…ç½®çš„æ—¶å€™å¯èƒ½æ³¨æ„ã€‚æœ‰æ—¶å€™å‡ºé”™çš„è¯ï¼Œå¯èƒ½è·Ÿè¿™ä¸ªæ‰§è¡Œé¡ºåºæœ‰å…³ã€‚ä»”ç»†æƒ³ä¸€ä¸‹ï¼Œé‚£ä¹ˆå¤šèŠ‚ç‚¹ï¼Œéƒ½è¦è¢«æ¯ä¸ªæ’ä»¶è½®æµæ‰§è¡Œä¸€éã€‚è¿™ä¸ªå¯¹æ€§èƒ½å½±å“ä¹Ÿæ˜¯å¾ˆå¤§çš„ã€‚æ‰€ä»¥å°½é‡ç”¨å…·ä½“çš„babel pluginæ¥é…ç½®ï¼Œå¹²æ‰stageçš„presetä»ä¸€æ–¹é¢é¿å…äº†è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœä¸é…ç½®æ’ä»¶ä»»ä½•æ’ä»¶åŠpresetã€babelå¯¹ä»£ç ä¸ä¼šåšåšä»»ä½•è½¬æ¢ å°†ä¼šè¾“å‡ºæœ€åˆçš„ä»£ç ã€‚å…³äºå…·ä½“çš„é…ç½®ï¼Œç®€å•ä»‹ç»ä¸‹å¯¹async/awaitä»¥åŠdecoratorsé…ç½®æ–¹å¼ã€‚</p>
<h4 id="å…³äº-async-await"><a href="#å…³äº-async-await" class="headerlink" title="å…³äº async/await"></a>å…³äº async/await</h4><ul>
<li>async/await åœ¨ES8çš„æ­£å¼ç‰ˆå‘å¸ƒäº†ï¼Œç›®å‰å±äºESçš„æ­£å¼æ ‡å‡†ï¼Œç†è®ºä¸Šæ¥è¯´é…ç½®ä¸‹envå³å¯ä»¥ä½¿ç”¨äº†ï¼Œä½†æ˜¯ä¸Šé¢ä¹Ÿæœ‰æåˆ° babelçš„pluginåªåšè¯­æ³•è½¬æ¢ï¼Œenvå¯ä»¥å°†async/awaitè¯­æ³•è½¬æ¢ä¸ºæ—§å¼çš„è¯­æ³•ã€‚ä½†æ˜¯è½¬æ¢åçš„çš„ä»£ç é‡Œé¢ä½¿ç”¨äº†Promise å’Œ regeneratorRuntime è¿™ä¸¤ä¸ªAPIã€‚</li>
</ul>
<p>å¦‚æœé…ç½®ä¸º </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [[<span class="string">"@babel/env"</span>]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æºç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">name</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è½¬åŒ–åçš„ä»£ç ä¸º<br><img src="https://raw.githubusercontent.com/kunkun12/blog/master/imgs/1.jpg" alt=""><br>å¾ˆæ˜æ˜¾è¿™ä¸ªä»£ç æ˜¯æ‰§è¡Œçš„è¯ æŠ¥é”™ regeneratorRuntimeï¼Œå¯¹äºä¸æ”¯æŒPromiseçš„æµè§ˆå™¨ä¹Ÿä¼š æŠ¥é”™ã€‚åœ¨é…ç½®ä¸­æ·»åŠ  <code>&quot;useBuiltIns&quot;: &quot;usage&quot;</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [[<span class="string">"@babel/env"</span>, &#123;</span><br><span class="line">        <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span></span><br><span class="line">    &#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¼–è¯‘ä¹‹åçš„ä»£ç ä¸º<br><img src="https://raw.githubusercontent.com/kunkun12/blog/master/imgs/2.jpg" alt=""><br>å‘ç°é¡¶éƒ¨å¤šäº†å¦‚ä¸‹ä¸¤è¡Œä»£ç  å¼•å…¥äº† å¦‚ä¸Šä¸¤ä¸ªæ–¹æ³•çš„polyfill</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">"regenerator-runtime/runtime"</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"core-js/modules/es6.promise"</span>);</span><br></pre></td></tr></table></figure>
<p>åˆšæ‰è¯´è¿‡äº†ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>@babel/plugin-transform-runtime</code>ç»“åˆ<code>@babel/runtime</code> æ¥å®ç°polyfillçš„åŠŸèƒ½ã€‚<br>éœ€è¦å®‰è£…ä¸¤ä¸ªä¾èµ–åŒ…</p>
<pre><code>npm install --save @babel/runtime
npm install --svae-dev @babel/plugin-transform-runtime
</code></pre><p>ä¿®æ”¹babelçš„é…ç½®<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [[<span class="string">"@babel/env"</span>]],</span><br><span class="line">    <span class="string">"plugins"</span>: [</span><br><span class="line">    [<span class="string">"@babel/plugin-transform-runtime"</span>, &#123;</span><br><span class="line">        <span class="string">"corejs"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">"helpers"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"regenerator"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"useESModules"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿è¡Œbabelä¹‹åç¼–è¯‘çš„ä»£ç ä¸º<br><img src="https://raw.githubusercontent.com/kunkun12/blog/master/imgs/2.jpg" alt=""><br>ï¼Œå¯ä»¥çœ‹åˆ° _regenerator(å³regeneratorRuntime)ä»¥å±€éƒ¨å˜é‡çš„å½¢å¼è¢«å¼•å…¥äº†ï¼Œéä¸Šé¢çš„å…¨å±€ä½œç”¨åŸŸã€‚å¦å¤– <code>asyncToGenerator</code>ä¹Ÿä½œä¸ºä¸€ä¸ªå·¥å…·å‡½æ•°è¢«æå–è‡³<code>@babel/runtime</code>,é€šè¿‡å¯¼å…¥åŒ…ï¼Œä»¥å±€éƒ¨å˜é‡çš„å½¢å¼åœ¨ä»£ç é‡Œé¢å‘ˆç°ã€‚å¦å¤–ç”±äºç¼–è¯‘åçš„ä»£ç åœ¨æ‰§è¡Œçš„æ—¶å€™ç”¨åˆ°äº† <code>@babel/runtime</code> åŒ…é‡Œé¢çš„ä»£ç ï¼Œå› æ­¤å®‰è£…ä¾èµ–çš„åŒ…çš„æ—¶å€™ï¼Œæ ¹æ®åŸåˆ™å°†å®‰è£…åˆ°dependenciesé‡Œé¢ï¼ˆâ€“save) ã€‚é‚£ä¹ˆè¿˜æœ‰ä¸ªé—®é¢˜ï¼ŒasyncToGeneratorç”¨äº†Promiseï¼Œå¯¹äºä¸æ”¯æŒPromiseçš„æµè§ˆå™¨ä¾ç„¶ä¼šæŠ¥é”™ã€‚è§£å†³æ–¹æ¡ˆå°±æ˜¯ å°†corejså±æ€§è®¾ç½®ä¸º2ï¼Œæ„æ€æ˜¯ä» <code>@babel/runtime-corejs2</code>ä¸­å»åŠ è½½polyfillï¼Œè¿™ä¸ªé‡Œé¢asyncToGeneratoré‡Œé¢åŒ…å«äº†å¿…è¦çš„ä¾èµ– æ¯”å¦‚<code>Promise</code> .éœ€è¦å…ˆéœ€è¦å®‰è£… runtime-corejs2: <code>npm install @babel/runtime-corejs2 --save</code>ã€‚è®¾ç½®å®Œæ¯•ä¹‹åï¼Œé‡æ–°ç¼–è¯‘ä»£ç ç»“æœ(è‡ªè¡Œä¸ä¸Šå›¾å¯¹æ¯”å‰ä¸‰è¡Œä»£ç )<br><img src="https://raw.githubusercontent.com/kunkun12/blog/master/imgs/4.jpg" alt=""></p>
<p>æŸ¥é˜…äº†ä¸€ä¸‹ <code>@babel/runtime-corejs2/helpers/asyncToGenerator</code>æ¨¡å— ç¬¬ä¸€è¡Œä¹Ÿç¡®å®å¼•å…¥äº†promiseï¼Œéƒ¨åˆ†å†…å®¹å¦‚ä¸‹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _Promise = <span class="built_in">require</span>(<span class="string">"../core-js/promise"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asyncGeneratorStep</span>(<span class="params">gen, resolve, reject, _next, _throw, key, arg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> info = gen[key](arg);</span><br><span class="line">    <span class="keyword">var</span> value = info.value;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    reject(error);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (info.done) &#123;</span><br><span class="line">    resolve(value);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    _Promise.resolve(value).then(_next, _throw);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="å…³äº-decrotors-è¯­æ³•æ”¯æŒ"><a href="#å…³äº-decrotors-è¯­æ³•æ”¯æŒ" class="headerlink" title="å…³äº decrotors è¯­æ³•æ”¯æŒ"></a>å…³äº decrotors è¯­æ³•æ”¯æŒ</h4><p>â€œDecoratorsâ€ä»å¥½ä¸‰å¹´å‰å°±å¼€å§‹ç‚’çš„ç‰¹æ€§ï¼Œè¿™ä¸ªç‰¹æ€§åœ¨<code>Typescript</code> ã€ <code>angular</code>ã€ <code>mobx</code>ä¸­å¹¿ä¸ºä½¿ç”¨ï¼Œç„¶è€Œç»è¿‡å¤šå¹´çš„åŠªåŠ›ï¼Œ<code>Decorators</code>çš„æ˜¯ç›®å‰ä»ç„¶å¤„äº<code>Stage2</code>ï¼Œbabelå®˜æ–¹ä»babel 5 å°±æœ‰æ”¯æŒ <code>Decorators</code>çš„pluginï¼Œå› ä¸ºè‰æ¡ˆä¸ç¨³å®šçš„åŸå› ï¼Œåœ¨babel6ä¸­ä»å†…ç½®æ’ä»¶ä¸­ç§»é™¤äº†å¯¹â€œè£…é¥°å™¨â€è¯­æ³•è½¬æ¢çš„æ”¯æŒï¼Œä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨ â€œæ°‘é—´â€çš„ç¬¬ä¸‰æ–¹æ’ä»¶(babel-plugin-transform-decorators-legacy)æ¥è½¬æ¢è£…é¥°å™¨è¯­æ³•ï¼Œbabel7ä¸­æŠŠè¿™ä¸ªæ’ä»¶çº³å…¥äº†babelçš„å†…ç½®æ’ä»¶åˆ—è¡¨ä¸­,åå­—ä¹Ÿæ”¹ä¸º <a href="https://babeljs.io/docs/en/babel-plugin-proposal-decorators" target="_blank" rel="noopener"><code>@babel/plugin-proposal-decorators</code> </a>ã€‚é…ç½®èµ·æ¥æ¯”è¾ƒç®€å•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [[<span class="string">"@babel/env"</span>]],</span><br><span class="line">    <span class="string">"plugins"</span>: [[<span class="string">"@babel/plugin-proposal-decorators"</span>, &#123;</span><br><span class="line">        <span class="string">"legacy"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸€äº›ç¬¬ä¸‰æ–¹Babel-Plugin"><a href="#ä¸€äº›ç¬¬ä¸‰æ–¹Babel-Plugin" class="headerlink" title="ä¸€äº›ç¬¬ä¸‰æ–¹Babel Plugin"></a>ä¸€äº›ç¬¬ä¸‰æ–¹Babel Plugin</h3><p>å®˜æ–¹æä¾›çš„plugin ä¸€èˆ¬æ˜¯ç”¨æ¥å¯¹ç›®å‰æˆå‹çš„æ ‡å‡†æˆ–è€…è‰æ¡ˆè¿›è¡Œé€šç”¨çš„è½¬æ¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œæ¥å®šåˆ¶è‡ªå·±çš„è½¬æ¢è§„åˆ™ï¼Ÿå—ç›Šäºbabelæä¾›çš„æ’ä»¶æ‰©å±•æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å®Œæˆå¯¹è¯­æ³•æ ‘è¿›è¡Œæ“ä½œï¼Œä»è€Œå¯¹ä»£ç çš„è½¬æ¢ï¼Œåªéœ€è¦å…³æ³¨è¯­æ³•çš„transformè¿™ä¸ªå…³é”®çš„æ­¥éª¤ï¼Œè‡ªå®šä¹‰Visitorï¼Œåˆ©ç”¨babelæä¾›çš„APIå¯ä»¥æ–¹ä¾¿çš„æ“ä½œè¯­æ³•æ ‘çš„èŠ‚ç‚¹ï¼Œå…¶ä»–çš„å·¥ä½œæ¯”å¦‚è¯­æ³•æ ‘è§£æï¼Œéå†ç®—æ³•ã€ä»£ç ç”Ÿæˆç­‰ç”± Babelå¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆè¿™äº›æ­¥éª¤ã€‚å¦‚æœå¯¹ç¼–å†™babelæ’ä»¶æœ‰å…´è¶£ï¼Œå¯ä»¥å»å‚è€ƒ<a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/plugin-handbook.md" target="_blank" rel="noopener">babelæ’ä»¶æ‰‹å†Œ</a>ã€‚ï¼ˆè¿™ç¯‡æ–‡ç« å†™å¾ˆè¯¦ç»†ï¼Œç†Ÿæ‚‰ä¹‹åå†™æ’ä»¶æ²¡å•¥é—®é¢˜äº†ï¼Œ å¦‚æœç¬¬ä¸€æ¬¡çœ‹ï¼Œä¸ç”¨å®³æ€•ï¼Œç»†å¿ƒçš„çœ‹ä¸‹å»ï¼Œå¤šçœ‹ä¸€éï¼Œå¯èƒ½ä¸€äº›é™Œç”Ÿçš„è¯æ±‡æœ‰äº›å”¬äººï¼Œ åˆ©ç”¨Babel APIæ“ä½œAST ï¼Œç›¸å½“äºä½¿ç”¨jQueryæ¥æ“ä½œDOMæ ‘ï¼‰ã€‚ä¸€å®šè¦å–„äºåˆ©ç”¨ASTçš„ç¥å™¨<a href="https://astexplorer.net" target="_blank" rel="noopener">astexplorer</a> æˆ–è€… <a href="http://esprima.org/demo/parse.html" target="_blank" rel="noopener">http://esprima.org/demo/parse.html</a> æˆ–è€… ä½¿ç”¨<a href="https://resources.jointjs.com/demos/rappid/apps/Ast/index.html" target="_blank" rel="noopener">JAVASCRIPT AST VISUALIZER</a>å¯è§†åŒ–æŸ¥çœ‹è¯­æ³•æ ‘ç»“æ„</p>
<p>ç¤¾åŒºä¸­æœ‰ä¸€äº›ä¸ºäº†æ»¡è¶³ç‰¹å®šéœ€æ±‚çš„pluginï¼Œå¯¹å®é™…é¡¹ç›®å¼€å‘ä¸­å¾ˆæœ‰ç”¨å¤„ï¼Œè¿™é‡Œä¸¾ä¾‹ä»‹ç»ä¸¤ä¸ªï¼Œæˆ‘ä»¬é€šè¿‡è¯»è¿™äº›æ’ä»¶çš„æºç ä¹Ÿèƒ½æœ‰åŠ©äºæˆ‘ä»¬æŒæ¡babelçš„æ’ä»¶å¼€å‘</p>
<ul>
<li><a href="https://www.npmjs.com/package/babel-plugin-import" target="_blank" rel="noopener">babel-plugin-import</a> åœ¨importé˜¶æ®µè¿›è¡Œè½¬æ¢ï¼Œåªå¯¼å…¥éœ€è¦çš„æ–‡ä»¶ï¼Œå°†å¯¼å…¥æ•´ä¸ªåº“çš„ä»£ç è½¬ä¸ºåªå¯¼å…¥å•ä¸ªçš„ç»„ä»¶æ–‡ä»¶ã€é¿å…å¯¼å…¥æ•´ä¸ªåº“ã€‚é€‚ç”¨äº antd, antd-mobile, lodash, material-ui</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-preval" target="_blank" rel="noopener">babel-plugin-preval</a> åœ¨nodeJSç¯å¢ƒä¸‹æ‰§è¡Œä»£ç è¿”å›å‡½æ•°æ‰§è¡Œçš„ç»“æœã€‚</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-codegen" target="_blank" rel="noopener">babel-plugin-codegen</a> åœ¨nodeJSç¯å¢ƒä¸‹æ‰§è¡Œä»£ç ï¼Œè¿”å›çš„ç»“æœå­—ç¬¦ä¸²ï¼Œä½œä¸ºJavaScriptè¯­å¥è¡¨è¾¾å¼æ’å…¥åˆ°ä»£ç ä¸­ æ¯”å¦‚æ¥¼ä¸ŠåŠŸèƒ½æ›´å¼º</li>
<li>babel-plugin-transform-remove-console åŠŸèƒ½å¦‚å…¶å</li>
</ul>
<h3 id="Babel-macros"><a href="#Babel-macros" class="headerlink" title="Babel macros"></a>Babel macros</h3><p>å…³äºBabelæ’ä»¶çš„ä½¿ç”¨ä¹Ÿæœ‰ä¸€äº›å°é—®é¢˜:</p>
<ul>
<li>åœ¨çœ‹ä¸€ä¸ªé¡¹ç›®çš„ä»£ç çš„æ—¶å€™ï¼Œæ— æ³•ç¡®å®šä»£ç æ˜¯å¦è¦ç»ç”±ä¸€ä¸ªæ’ä»¶è½¬æ¢ï¼Œå¯¹äºæ–°äººé˜…è¯»ä»£ç  å®¹æ˜“é€ æˆè¿·æƒ‘</li>
<li>å¯ç”¨ä¸€ä¸ªæ’ä»¶ å¿…é¡»ä¿®æ”¹babelçš„é…ç½®æ–‡ä»¶æˆ–è€…webpackçš„é…ç½®</li>
<li>éå†èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ‰§è¡Œå¤šä¸ªæ’ä»¶ å¯èƒ½ä¼šé€ æˆå†²çªï¼Œå¸¦æ¥å›°æ‰°</li>
</ul>
<p>è¿™ä¸ªæ—¶å€™å°±æœ‰ä¸€ç§éœ€æ±‚ï¼šä¸æ”¹å˜Babelé…ç½®çš„æƒ…å†µä¸‹ï¼Œåœ¨åº”ç”¨çš„ä»£ç é‡Œé¢åŠ¨æ€ä¸ºç‰¹å®šçš„ä»£ç åº”ç”¨æŒ‡å®šçš„è¯­æ³•è½¬æ¢ï¼Œbabel macroså°±æ˜¯æ»¡è¶³ä¸ºäº†è¿™ä¸ªéœ€æ±‚ï¼Œbabel macros çš„æƒ³æ³•çš„æ¥æºäº<a href="https://github.com/facebook/create-react-app/issues/2730" target="_blank" rel="noopener">create-react-appçš„ä¸€ä¸ªissue</a>ï¼Œç›®å‰macroså·²ç»åœ¨create-react-appä¸­ä½¿ç”¨äº†ï¼Œ(create-react-appä¸æ¨èç”¨æˆ·è‡ªè¡Œä¿®æ”¹é…ç½®æ–‡ä»¶)ã€‚å®çš„åŠŸèƒ½ä¸babel pluginåŠŸèƒ½ä¸Šå·®ä¸å¤šï¼Œbabel pluginçš„å¼•å…¥éœ€è¦åœ¨babelçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼Œåªæ˜¯å®æ˜¯è®©æˆ‘ä»¬å¯ä»¥å¯¹æ‰‹åŠ¨æŒ‡å®šçš„ä»£ç è¿›è¡Œè¯­æ³•è½¬æ¢çš„ã€‚babel æœ‰è®¸å¤špluginï¼Œä¹Ÿæœ‰è®¸å¤šçš„macroå¯ç”¨ï¼Œä¸åŒçš„å®åŠŸèƒ½ä¸åŒã€‚macroçš„å‡ºç°è®©æˆ‘ä»¬åœ¨ä»£ç ä¸­æ‰‹åŠ¨çš„ä½¿ç”¨babelçš„è½¬æ¢åŠŸèƒ½ã€‚</p>
<p>å¦‚æœæ˜¯ä½¿ç”¨macros éœ€è¦å…ˆå®‰è£…babel-plugin-macrosï¼Œå¯ç”¨macrosçš„èƒ½åŠ› <code>npm install --save-dev babel-plugin-macros</code> ã€‚babel-plugin-macros ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„macroï¼Œåªæ˜¯ç»™macroæä¾›äº†ä¸€ä¸ªè¿è¡Œçš„å¹³å°ï¼Œä¸å…·æœ‰è½¬æ¢ç‰¹å®šä»£ç çš„åŠŸèƒ½ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨å®çš„æ—¶å€™ï¼Œéœ€è¦åœ¨babelé…ç½®æ–‡ä»¶<code>plugins</code>é‡Œé¢æ·»åŠ <code>macros</code>ã€ä¹‹åä½¿ç”¨å…·ä½“çš„å®ä¸éœ€è¦å†æ”¹babelçš„é…ç½®ã€‚è¿™é‡Œå¯ä»¥æŸ¥çœ‹å…·ä½“å¯ç”¨çš„<a href="https://github.com/kentcdodds/babel-plugin-macros/blob/master/other/docs/macros.md" target="_blank" rel="noopener">macros</a> æ ¹æ®éœ€æ±‚å®‰è£…å¯¹åº”çš„macros åœ¨ä»£ç é‡Œé¢ä½¿ç”¨å³å¯ã€‚è¯´äº†è¿™äº›è¿˜æ˜¯ä¸ç›´è§‚ï¼Œä¸‹é¢ä»¥<code>penv.macro</code>ä»‹ç»ä¸‹å…·ä½“å¦‚ä½•ä½¿ç”¨å®ã€‚</p>
<p>penv.macro ç”¨æ¥åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç»Ÿä¸€ç®¡ç†ä½ çš„ç¯å¢ƒå˜é‡, å¹¶ä¸”åªä¿ç•™ä¸å½“å‰ç¯å¢ƒå˜é‡åŒ¹é…çš„å€¼ã€‚ä¸å½“å‰ç¯å¢ƒæ— å…³çš„ä»£ç è¢«ç§»é™¤ï¼Œç¡®ä¿ä¸ä¼šå°†ä¸æŒ‡å®šç¯å¢ƒä¸ç›¸å¹²çš„ä»£ç å‘å¸ƒåˆ°å¯¹åº”çš„ç¯å¢ƒä¸Š.</p>
<ol>
<li><code>npm install --save-dev babel-plugin-macros</code> ä¿®æ”¹babelé…ç½®æ–‡ä»¶åœ¨pluginsä¸­ æ·»åŠ  macros ï¼ˆä½¿ç”¨å®åŠŸèƒ½å¿…é¡»æœ‰è¿™ä¸€æ­¥ï¼Œæä¾›ä¸€ä¸ªè¿è¡Œå®çš„ç¯å¢ƒï¼‰</li>
<li><code>npm install penv.macro --save-dev</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> env <span class="keyword">from</span> <span class="string">'penv.macro'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BASE_URL = env(&#123;</span><br><span class="line">  development: <span class="string">'https://development.example.com'</span>,</span><br><span class="line">  staging: <span class="string">'https://staging.example.com'</span>,</span><br><span class="line">  production: <span class="function">(<span class="params">(</span>) =&gt;</span> <span class="string">'https://production.example.com'</span>)(),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>å‡è®¾ç¼–è¯‘çš„æ—¶å€™ process.env.NODE_ENV ä¸º productionï¼Œç¼–è¯‘åçš„ç»“æœå¦‚ä¸‹ï¼Œè¿™ä¸ªåŠŸèƒ½ä¸webpackä¸­çš„DefinePluginåŠŸèƒ½ç±»ä¼¼ï¼Œç„¶è€Œè¿™ç§æ–¹å¼ä½¿ç”¨èµ·æ¥è¦æ„Ÿè§‰èˆ’æœå¾ˆå¤šã€‚ç»Ÿä¸€ç®¡ç†ï¼Œä¸ä¾èµ–webpackçš„é…ç½®ï¼Œä¹Ÿæ–¹ä¾¿å°±è¿‘ç»´æŠ¤ï¼ŒåŒæ—¶ä¹Ÿé¿å…ä¸Šçº¿åæ··æ‚äº†å…¶ä»–ç¯å¢ƒä¸‹çš„ä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> BASE_URL = <span class="function">(<span class="params">(</span>) =&gt;</span> <span class="string">'https://production.example.com'</span>)()</span><br></pre></td></tr></table></figure></p>
<p>å®ä¸ºæˆ‘ä»¬æä¾›äº†è§£å†³é—®é¢˜çš„å¦ä¸€ç§æ€è·¯,æ‰€æœ‰çš„å®éƒ½ä»¥/macroä¸ºåç¼€ï¼Œåœ¨ä»£ç ä¸­æ˜¾å¼å¯¼å…¥å®ï¼Œåœ¨éœ€è¦çš„åœ°æ–¹è°ƒç”¨å…·ä½“çš„å®ï¼Œä¹Ÿèƒ½æ–¹ä¾¿å¯¹åŠŸèƒ½çš„ç†è§£ï¼Œå¿ƒé‡Œä¹Ÿæ¸…æ¥šè¿™è¡Œä»£ç è¦è¢«Babel macroæ¥è½¬æ¢ï¼ˆè‹¥ä½¿ç”¨æ’ä»¶ï¼Œè¯­æ³•è¢«è½¬æ¢äº†ï¼Œå¯èƒ½ä¸æ¸…æ¥šæ˜¯ä»€ä¹ˆåŸå› é€ æˆçš„)ï¼Œå¢åŠ æ–°çš„å®ä¹Ÿä¸éœ€è¦ä¿®æ”¹babelçš„é…ç½®ï¼ŒåŒæ—¶ä¹Ÿèƒ½é¿å…æ’ä»¶é¡ºåºé…ç½®é—®é¢˜å¯¼è‡´çš„å†²çªã€‚è¿™é‡Œæœ‰ä¸€äº›å¯ç”¨çš„<a href="https://github.com/jgierer12/awesome-babel-macros" target="_blank" rel="noopener">å®åˆ—è¡¨</a> å¦å¤–æŠŠæ’ä»¶è½¬æ¢ä¸ºå®ä¹Ÿå¾ˆå®¹æ˜“ï¼Œæ¯”å¦‚ ä¸Šé¢ä»‹ç»çš„ prevalã€å’Œcodegenæ’ä»¶å°±æœ‰å¯¹åº”çš„ preval.macro å’Œ codegen.macroã€‚ä¹Ÿæœ‰äºº<a href="https://medium.freecodecamp.org/using-babel-macros-with-react-native-8615aaf5b7df" target="_blank" rel="noopener">åŸºäºcodegen.macroæ¥å®ç°å›½é™…åŒ–æ–¹æ¡ˆ</a>ã€‚å¦å¤–æ›´å¥½çš„å›½é™…åŒ–æ–¹æ¡ˆå¯ä»¥ä½¿ç”¨ <a href="https://lingui.js.org/ref/macro.html" target="_blank" rel="noopener">@lingui/macro</a></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å†™äº†è¿™äº› å¸Œæœ›èƒ½å¯¹babelæœ‰ä¸€äº›äº†è§£ï¼ŒBabelä¸æ­¢å¯ä»¥ç”¨æ¥åšæ ‡å‡†çš„è¯­æ³•è½¬æ¢ï¼Œè¿˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ç¼–è¯‘æ‰‹æ®µæ¥è§£å†³å·¥ç¨‹åŒ–çš„ä¸€äº›é—®é¢˜ï¼ŒBabel APIç»™æˆ‘ä»¬æä¾›äº†æ–¹ä¾¿æ“ä½œè¯­æ³•æ ‘çš„å·¥å…·ï¼Œè®©å®šåˆ¶éœ€æ±‚å˜çš„ç®€å•ã€‚æœ¬æ–‡æ›´å¤šçš„æ˜¯ä»‹ç»ä¸€äº›æ€è·¯ä»¥åŠå­¦ä¹ æ–¹å‘ï¼Œå¾ˆå¤šä¸œè¥¿è¦å†™ï¼Œå—é™äºç¬”å¢¨ï¼Œæ²¡æœ‰å†™å¤ªå¤šï¼Œé‡Œé¢æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼Œéƒ½å¯ä»¥æ·±å…¥æ¥ç ”ç©¶ï¼Œå¦å¤–æ–‡ç« ä¸­æ¶‰åŠé“¾æ¥æ–‡ç« éƒ½æœ‰å¾ˆå¥½çš„æŒ‡å¯¼æ„ä¹‰ã€‚</p>
<h3 id="One-More-things-å…³äºbabelä½œè€…çš„å…«å¦"><a href="#One-More-things-å…³äºbabelä½œè€…çš„å…«å¦" class="headerlink" title="One More things å…³äºbabelä½œè€…çš„å…«å¦"></a>One More things å…³äºbabelä½œè€…çš„å…«å¦</h3><p>6to5 çš„ä½œè€… Sebastian McKenzieæ˜¯ä¸ªæ¾³å¤§åˆ©äºšäººï¼Œ8å²çš„æ—¶å€™å‘å¸ƒçš„è‡ªå·±ç¬¬ä¸€ä¸ªç½‘ç«™ï¼Œ2014å¹´17å²çš„åœ¨é«˜ä¸­çš„æ—¶å€™å¼€å§‹ç©github ç„¶åç¬¬ä¸€æ¬¡commit å°±æ˜¯ 6to5ï¼Œåœ¨é¡¹ç›®ä¸Šå¾ˆä¸Šå¿ƒï¼Œbugåé¦ˆå‡ åˆ†é’Ÿä¹‹åå°±èƒ½è¢«ä¿®å¤ï¼Œå› ä¸ºä¸€ç›´ç›¯ç€ç”µè„‘ï¼Œæ²¡æœ‰åˆ«çš„äº‹æƒ…åšã€‚ã€‚ã€‚ä¸å–œæ¬¢ä¸Šå­¦ï¼Œæˆç»©ä¸å¥½ï¼Œæ²¡æœ‰ä¸Šå¤§å­¦ï¼Œé«˜ä¸­ç»“æŸåï¼Œæƒ³æ‰¾ä¸ªnodeJS åˆçº§å·¥ç¨‹å¸ˆçš„å·¥ä½œï¼Œç®€å†ä¸Šä¹Ÿé™„ä¸Šè‡ªå·±é¡¹ç›®çš„ä»£ç ï¼Œç„¶è€Œä¹Ÿå¤šæ¬¡ç¢°å£ï¼ŒæŠ•ç®€å†çš„å…¬å¸å¯¹ä»–åšçš„äº‹æƒ…ä¹Ÿä¸æ„Ÿå…´è¶£ã€‚ã€‚è¾›è‹¦ä¹‹ä¸‹å¥½ä¸å®¹æ˜“åœ¨11æœˆåœ¨æ‚‰å°¼ä»½æ‰¾åˆ°ä¸€ä»½å·¥ä½œï¼Œæ²¡è°ˆè–ªèµ„å°±æŠŠofferæ¥äº†ã€‚å¹²äº†ä¸‰ä¸ªæœˆå»ä¼¦æ•¦CloudFlareã€‚2015å¹´å»äº†ç¾å›½åŠ å…¥äº†CloudFlare å¯ä»¥å¼€å¿ƒçš„å†™nodeäº†ã€‚ã€‚ã€‚2015.2æœˆ å¹´6to5 æ”¹åä¸ºBabelã€‚<a href="https://reactjs.org/blog/2015/06/12/deprecating-jstransform-and-react-tools.html" target="_blank" rel="noopener">2015-6æœˆ facebook å®£å¸ƒ React and React Nativeçš„æ„å»ºç³»ç»ŸåŸºäºBabelæ›¿æ¢è‡ªå®¶çš„JSTransform</a> ï¼ŒåŒå¹´ä¸ƒæœˆ18å²çš„ Sebastian åŠ å…¥facebookï¼Œæˆªæ­¢ç›®å‰è¿˜åœ¨ã€‚</p>
<h4 id="å­¦ä¹ èµ„æ–™-è¿™äº›å¥½å¥½çœ‹å®Œå°±æˆbabelé«˜æ‰‹äº†"><a href="#å­¦ä¹ èµ„æ–™-è¿™äº›å¥½å¥½çœ‹å®Œå°±æˆbabelé«˜æ‰‹äº†" class="headerlink" title="å­¦ä¹ èµ„æ–™ è¿™äº›å¥½å¥½çœ‹å®Œå°±æˆbabelé«˜æ‰‹äº†"></a>å­¦ä¹ èµ„æ–™ è¿™äº›å¥½å¥½çœ‹å®Œå°±æˆbabelé«˜æ‰‹äº†</h4><ul>
<li><a href="https://babeljs.io/docs/en/" target="_blank" rel="noopener">babelå®˜ç½‘</a>ã€ <a href="https://babeljs.io/blog/" target="_blank" rel="noopener">ä»¥åŠç›¸å…³åšå®¢</a></li>
<li><a href="https://xiaoiver.github.io/coding/2018/05/12/Babel-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html" target="_blank" rel="noopener">Babel æ’ä»¶å¼€å‘</a></li>
<li><a href="http://www.alloyteam.com/2017/04/analysis-of-babel-babel-overview/" target="_blank" rel="noopener">http://www.alloyteam.com/2017/04/analysis-of-babel-babel-overview/</a></li>
<li><a href="https://github.com/kentcdodds/babel-plugin-macros" target="_blank" rel="noopener">babel-plugin-macros</a></li>
<li><a href="https://babeljs.io/blog/2017/09/11/zero-config-with-babel-macros" target="_blank" rel="noopener">zero-config-with-babel-macros</a></li>
<li><a href="https://blog.kentcdodds.com/how-writing-custom-babel-and-eslint-plugins-can-increase-your-productivity-and-improve-user-fd6dd8076e26" target="_blank" rel="noopener">How writing custom Babel &amp; ESLint plugins can increase productivity &amp; improve user experience</a></li>
<li><a href="https://github.com/kentcdodds/babel-plugin-macros/tree/master/other/docs" target="_blank" rel="noopener">https://github.com/kentcdodds/babel-plugin-macros/tree/master/other/docs</a></li>
<li><a href="https://scotch.io/tutorials/javascript-transpilers-what-they-are-why-we-need-them#toc-using-transpilers" target="_blank" rel="noopener">JavaScript Transpilers: What They Are &amp; Why We Need Them</a></li>
<li><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/user-handbook.md" target="_blank" rel="noopener">Babel ç”¨æˆ·æ‰‹å†Œ</a></li>
<li><a href="https://juejin.im/entry/5ad41747518825558002b2a7" target="_blank" rel="noopener">penv.macro - ä½¿ç¯å¢ƒå˜é‡çš„è®¾ç½®æ›´åŠ ç®€å•</a></li>
<li><a href="https://medium.freecodecamp.org/using-babel-macros-with-react-native-8615aaf5b7df" target="_blank" rel="noopener">How to use Babel macros with React Native</a></li>
<li><a href="astexplorer.net">astexplorer.net</a></li>
<li><a href="http://slides.com/kentcdodds/a-beginners-guide-to-asts" target="_blank" rel="noopener">Writing custom Babel and ESLint plugins</a></li>
<li><a href="https://itnext.io/ast-for-javascript-developers-3e79aeb08343" target="_blank" rel="noopener">AST for JavaScript developers</a></li>
<li><a href="https://www.youtube.com/watch?v=d0pOgY8__JM&amp;feature=youtu.be" target="_blank" rel="noopener">Christoph Pojer: Evolving Complex Systems Incrementally | JSConf EU 2015</a></li>
<li><a href="https://vramana.github.io/blog/2015/12/21/codemod-tutorial/" target="_blank" rel="noopener">Ramana Venkata: How to write a codemod</a></li>
<li><a href="https://www.youtube.com/watch?v=8uOXIM4giH8" target="_blank" rel="noopener">Jamund Ferguson: Harnessing The Power of Abstract Syntax Trees</a></li>
<li><a href="https://www.youtube.com/watch?v=Tar4WgAfMr4" target="_blank" rel="noopener">James Kyle: How to Build a Compiler</a></li>
<li><a href="https://eslint.org/docs/developer-guide/working-with-plugins" target="_blank" rel="noopener">ESLint: Working with Plugins</a></li>
<li><a href="https://github.com/estree/estree" target="_blank" rel="noopener">ESTree â€œspecâ€</a></li>
<li><a href="https://www.henryzoo.com/babel-plugin-slides/assets/player/KeynoteDHTMLPlayer.html" target="_blank" rel="noopener">â€œHow Writing a Babel Plugin is like jQueryâ€</a></li>
<li><a href="https://babeljs.io/docs/en/babel-types" target="_blank" rel="noopener">Babel Types Documentation</a></li>
<li><a href="http://slides.com/kentcdodds/macros#/" target="_blank" rel="noopener">All about macros</a></li>
<li><a href="https://dev.to/stereobooster/how-to-write-simple-babel-macro-1al1" target="_blank" rel="noopener">How to write simple babel macro</a></li>
<li>Babelä½œè€…è‡ªè¿°<a href="https://medium.com/@sebmck/2015-in-review-51ac7035e272" target="_blank" rel="noopener">2015 in review</a></li>
</ul>

        

      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/AST-Babel-æŠ½è±¡è¯­æ³•æ ‘/">
                #AST Babel æŠ½è±¡è¯­æ³•æ ‘
              </a>
            
          </div>
        

        

        
          <div class="post-eof the-shape"></div>
        
      </div>
    
  </div>


  
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2017/10/15/nightwatch/">
                web ç«¯åˆ°ç«¯æµ‹è¯•å·¥å…· Nightwatch.js
              </a>
            
          
        </h1>
      

      <div class="post-meta">
          <span class="post-time">
            
              å‘è¡¨äº 2017-10-15
            
          </span>
        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2017/10/15/nightwatch/#comments">
              <span class="post-comments-count ds-thread-count" data-thread-key="2017/10/15/nightwatch/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <h3 id="Nightwath-ä»‹ç»"><a href="#Nightwath-ä»‹ç»" class="headerlink" title="Nightwath ä»‹ç»"></a>Nightwath ä»‹ç»</h3><p>è¯´èµ·end to end æµ‹è¯•,å¯ä»¥ç†è§£ä¸ºæ¨¡æ‹Ÿç”¨æˆ·çš„è¡Œä¸ºè§‚å¯Ÿé¡µé¢ã€ç‚¹å‡»é¡µé¢æ˜¯å¦ä¸é¢„æœŸçš„ç»“æœç›¸ç¬¦ï¼Œä¸€èˆ¬å¸¸ç”¨çš„æ˜¯Seleniumï¼Œï¼Œå®ƒæä¾›äº†APIç”¨äºè‡ªåŠ¨åŒ–çš„æµ‹è¯•ï¼ŒSeleniumä½¿ç”¨çš„æ˜¯ä¸€å¥—æ ‡å‡†çš„ W3C çš„ Web Driver API ï¼ˆä¸€å¥—ç”¨äºè‡ªåŠ¨åŒ–æµ‹è¯•çš„åè®®ã€è¯¥åè®®å·²ç»æˆäº†äº‹å®çš„æ ‡å‡† ï¼‰ï¼Œè€ŒNightwatch(å®˜ç½‘åœ°å€ <a href="http://nightwatchjs.org" target="_blank" rel="noopener">http://nightwatchjs.org</a>) ä¹Ÿæ˜¯åœ¨è¿™å¥—åè®®åŸºç¡€ä¹‹ä¸Šæä¾›çš„ä¸€å¥—NodeJSçš„APIï¼Œç‰¹ç‚¹æ˜¯è¯­æ³•ç®€æ´ã€ä½¿ç”¨æ–¹ä¾¿ï¼Œæ”¯æŒå„ç§æµè§ˆå™¨ã€‚å®˜æ–¹æ–‡æ¡£å†™çš„éå¸¸è¯¦ç»†ï¼Œè¿™é‡Œåšä¸€ä¸‹ç®€å•çš„ä»‹ç»ã€‚ä¸‹é¢æ˜¯å®˜æ–¹ç»™å‡ºçš„å·¥ä½œåŸç†å›¾,çŒ«å¤´é¹°å°±æ˜¯è¡¨ç¤ºnightwatchï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨é€šè¿‡Web Driveråè®®ä¸ Seleniumäº¤äº’ï¼ŒSeleniumä¸nightwatchç›¸äº’é€šä¿¡æ¥å®Œæˆæ•´ä¸ªè¿‡ç¨‹ï¼Œnightwatchä¼šå¾€æµè§ˆå™¨ä¸­æ³¨å…¥ä»£ç ï¼Œæ¥æ“ä½œDomï¼Œç„¶åé€šè¿‡websocketå®Œæˆä¸æµ‹è¯•æœåŠ¡ç«¯çš„é€šä¿¡æ¥å±•ç¤ºæµ‹è¯•ä»»åŠ¡çš„ç»“æœã€‚</p>
<p><img src="http://nightwatchjs.org/img/operation.png" alt=""></p>
<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><h4 id="å®‰è£…-Nightwatch-ã€‚ä½¿ç”¨npmå…¨å±€å®‰è£…æˆ–è€…æœ¬åœ°å®‰è£…éƒ½è¡Œ"><a href="#å®‰è£…-Nightwatch-ã€‚ä½¿ç”¨npmå…¨å±€å®‰è£…æˆ–è€…æœ¬åœ°å®‰è£…éƒ½è¡Œ" class="headerlink" title="å®‰è£… Nightwatch ã€‚ä½¿ç”¨npmå…¨å±€å®‰è£…æˆ–è€…æœ¬åœ°å®‰è£…éƒ½è¡Œ"></a>å®‰è£… Nightwatch ã€‚ä½¿ç”¨npmå…¨å±€å®‰è£…æˆ–è€…æœ¬åœ°å®‰è£…éƒ½è¡Œ</h4><pre><code>npm install -g nigthwatch
</code></pre><p>æˆ–è€…<br>    <code>npm install nightwatch</code></p>
<h4 id="Selenium-Server"><a href="#Selenium-Server" class="headerlink" title="Selenium Server"></a>Selenium Server</h4><p>è¿™é‡Œéœ€è¦è°ƒç”¨Selenium Server æä¾›çš„APIï¼Œéœ€è¦å»ä¸‹è½½Selenium Serverçš„jaråŒ…(<a href="http://selenium-release.storage.googleapis.com/index.html)" target="_blank" rel="noopener">http://selenium-release.storage.googleapis.com/index.html)</a>, ä¸‹è½½æœ€æ–°çš„<code>selenium-server-standalone-{VERSION}.jar</code>å³å¯,å½“ç„¶éœ€è¦æœ¬æœºæœ‰Javaç¯å¢ƒ  Java versionè¦åœ¨7ä»¥ä¸Šã€‚</p>
<h3 id="æµè§ˆå™¨é©±åŠ¨ä¸‹è½½"><a href="#æµè§ˆå™¨é©±åŠ¨ä¸‹è½½" class="headerlink" title="æµè§ˆå™¨é©±åŠ¨ä¸‹è½½"></a>æµè§ˆå™¨é©±åŠ¨ä¸‹è½½</h3><p>Selenium æ”¯æŒä¸åŒçš„æµè§ˆå™¨ï¼Œå¯¹äºåˆ¶å®šçš„æµè§ˆå™¨éœ€è¦ä¸‹è½½ç‰¹å®šçš„ é©±åŠ¨ï¼Œè¿™é‡Œä»¥chromeä¸ºä¾‹ ä¸‹è½½åœ°å€ ï¼ˆ<a href="https://sites.google.com/a/chromium.org/chromedriver/downloads)ã€‚" target="_blank" rel="noopener">https://sites.google.com/a/chromium.org/chromedriver/downloads)ã€‚</a><br>è¿™é‡Œä¸ºäº†æ–¹ä¾¿æŠŠä¸‹è½½çš„Selenium Server ä»¥åŠ chromedriver ç»Ÿä¸€æ”¾åˆ°é¡¹ç›®çš„ binç›®å½•ä¸‹ éšé¡¹ç›®ä¸€èµ·æäº¤äº†ã€‚</p>
<h4 id="é…ç½®ä»¥åŠè¿è¡Œæµ‹è¯•ç”¨ä¾‹"><a href="#é…ç½®ä»¥åŠè¿è¡Œæµ‹è¯•ç”¨ä¾‹" class="headerlink" title="é…ç½®ä»¥åŠè¿è¡Œæµ‹è¯•ç”¨ä¾‹"></a>é…ç½®ä»¥åŠè¿è¡Œæµ‹è¯•ç”¨ä¾‹</h4><p>æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹</p>
<pre><code>{
  &quot;src_folders&quot;: [
    &quot;e2e&quot;
  ],
  &quot;output_folder&quot;: &quot;reports&quot;,
  &quot;selenium&quot;: {
    &quot;start_process&quot;: true,
    &quot;server_path&quot;: &quot;./bin/selenium-server.jar&quot;,
    &quot;log_path&quot;: &quot;&quot;,
    &quot;port&quot;: 4444,
    &quot;cli_args&quot;: {
      &quot;webdriver.chrome.driver&quot;: &quot;./bin/chromedriver&quot;
    }
  },
  &quot;test_settings&quot;: {
    &quot;default&quot;: {
      &quot;launch_url&quot;: &quot;http://localhost&quot;,
      &quot;selenium_port&quot;: 4444,
      &quot;selenium_host&quot;: &quot;127.0.0.1&quot;,
      &quot;silent&quot;: true,
      &quot;screenshots&quot;: {
        &quot;enabled&quot;: true,
        &quot;path&quot;: &quot;.&quot;
      },
      &quot;globals&quot;: {
        &quot;waitForConditionTimeout&quot;: 1000 
      },
      &quot;desiredCapabilities&quot;: {
        &quot;browserName&quot;: &quot;chrome&quot;,
        &quot;chromeOptions&quot;: {
          &quot;args&quot;: [
          &quot;--user-agent=Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Mobile Safari/537.36&quot;,
            &quot;--window-size=360,640&quot; 
          ]
        },
        &quot;javascriptEnabled&quot;: true,
        &quot;acceptSslCerts&quot;: true
      }
    }
  }
}
</code></pre><p><a href="http://nightwatchjs.org/gettingstarted/" target="_blank" rel="noopener">http://nightwatchjs.org/gettingstarted/</a> å®˜ç½‘ä¸Šæœ‰é…ç½®æ–‡ä»¶çš„å…·ä½“ä»‹ç»ï¼Œä¸åœ¨è¯¦ç»†å™è¿°ï¼Œéœ€è¦æ˜¯è®¾ç½®selenium ä»¥åŠ æµè§ˆå™¨é©±åŠ¨çš„è·¯å¾„ï¼Œè¿™é‡Œç”¨çš„æ˜¯ç›¸å¯¹ç›®å½•<br>æ–°å»º <code>nightwatch.conf.js</code>æ–‡ä»¶é‡Œé¢æ”¾å…¥</p>
<pre><code>module.exports = (function(settings) {
  settings.test_workers = false;
  return settings;
})(require(&apos;./nightwatch.json&apos;));
</code></pre><p>æ­¤æ—¶åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ nightwatch ä¼šè‡ªåŠ¨å¯åŠ¨è‡ªåŠ¨åŒ–æµ‹è¯•ç¨‹åºï¼Œè¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œä¸‹é¢ç¼–å†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹,æ–°å»º e2e/test.jsæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p>
<pre><code>  module.exports = {
  &apos;Demo test&apos; : function (browser) {
    browser
      .url(&quot;http://www.baidu.com&quot;)
      .waitForElementVisible(&apos;body&apos;, 1000)
      .setValue(&apos;#index-kw&apos;,&quot;é¢å‘å¯¹è±¡&quot;)
      .click(&apos;#index-bn&apos;)
      .assert.containsText(&apos;body&apos;, &apos;é¢å‘å¯¹è±¡&apos;)
      .saveScreenshot(&apos;./test.png&apos;)
      .end();
  }
};
</code></pre><p>ç»ˆç«¯ä¸‹æ‰§è¡Œ <code>nightwatch</code> å³å¯è¿è¡Œï¼ŒæŸ¥çœ‹æµ‹è¯•æŠ¥å‘Šï¼Œå¹¶å¾—åˆ°ä¸€å¼ æˆªå›¾ã€‚<br><em>å¦‚æœæ˜¯æœ¬åœ°å®‰è£…çš„nightwatch æ‰§è¡Œ<code>./node_modules/.bin/nightwatch</code> </em> ä¹Ÿå¯ä»¥é€šè¿‡npm script å½¢å¼æ¥æ‰§è¡Œã€‚è¯¥é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹</p>
<pre><code>â”€â”€ bin
â”‚   â”œâ”€â”€ chromedriver
â”‚   â””â”€â”€ selenium-server.jar
â”œâ”€â”€ e2e
â”‚   â””â”€â”€ test.js
â”œâ”€â”€ nightwatch.conf.js
â”œâ”€â”€ nightwatch.json
â”œâ”€â”€ package.json
</code></pre><p>ç¯å¢ƒæ­å»ºå¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œå®˜æ–¹æœ‰è¯¦ç»†çš„å¼€å‘è€…æŒ‡å¯¼ï¼Œä»¥åŠAPIæ–‡æ¡£ã€‚å¦å¤–Nightwatch ä¹Ÿå¯ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•ã€ä¸mocha ã€chaiç­‰çŸ¥åçš„å·¥å…·ç»“åˆä½¿ç”¨ã€‚</p>
<h4 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h4><ul>
<li>è‹±æ–‡çš„æ–‡æ¡£å¼„æ‡‚ nightwatchã€Selenium Serverã€æµè§ˆå™¨é©±åŠ¨ ä¸‰è€…ä¹‹å‰çš„å…³ç³»ï¼Œä»¥åŠè¿è¡ŒåŸç†</li>
<li>åœ¨chromeæµ‹è¯•æ¨¡æ‹Ÿç‚¹å‡»çš„æ—¶å€™ç¡®ä¿ è¢«ç‚¹å‡»çš„domæ˜¯å¯è§çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</li>
<li>ä¸€äº›nightwatch æ²¡æœ‰æä¾›çš„æ¨¡æ‹Ÿå™¨æ“ä½œï¼Œæ¯”å¦‚å°†æŸä¸ªdom scroll into Viewï¼Œéœ€è¦ä½¿ç”¨ execute æ–¹æ³• è‡ªå·±æ³¨å…¥jsä»£ç æ¥å®Œæˆã€‚</li>
</ul>

        

      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/AngularJS/">
                #AngularJS
              </a>
            
          </div>
        

        

        
          <div class="post-eof the-shape"></div>
        
      </div>
    
  </div>


  
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2017/03/14/react-native-webview-communicate/">
                react-nativeä¸webviewçš„åŒå‘é€šä¿¡
              </a>
            
          
        </h1>
      

      <div class="post-meta">
          <span class="post-time">
            
              å‘è¡¨äº 2017-03-13
            
          </span>
        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2017/03/14/react-native-webview-communicate/#comments">
              <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/14/react-native-webview-communicate/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <p>react native åœ¨å®˜ç½‘çš„æ–‡æ¡£ä¸­ï¼Œå¹¶æ²¡æœ‰è¯¦ç»†ä»‹ç»<a href="http://facebook.github.io/react-native/docs/webview.html#onmessage" target="_blank" rel="noopener">http://facebook.github.io/react-native/docs/webview.html#onmessage</a>å¦‚ä½•å®ç°RNä¸WebViewä¸­JavaScriptçš„é€šä¿¡ã€‚ å…³äº onMessageçš„æè¿°å¦‚ä¸‹ï¼Œ</p>
<pre><code>onMessage?: function 
A function that is invoked when the webview calls window.postMessage. Setting this property will inject a postMessage global into your webview, but will still call pre-existing values of postMessage.
window.postMessage accepts one argument, data, which will be available on the event object, event.nativeEvent.data. data must be a string.
</code></pre><p>ä»ä¸Šåªèƒ½çœ‹å‡ºï¼ŒRNå¯ä»¥æ¥å—æ¥è‡ªäºwebviewçš„æ¶ˆæ¯ï¼Œç„¶è€Œå¹¶æ— æ³•å¾—çŸ¥å¦‚ä½•ä»RNå¾€Webviewå†…éƒ¨å‘é€æ¶ˆæ¯ï¼Œè¯»æºç çš„æ—¶å€™ï¼Œå‘ç°äº† RNçš„webviewç»„ä»¶ä¸­é™¤äº†<code>onMessage</code> è¿˜æœ‰ä¸ª<code>posMessage</code>æ–¹æ³•ï¼Œç”±æ­¤å¯ä»¥æ¨å‡ºèƒ½æå®šRNä¸Webviewå†…H5çš„åŒå‘é€šä¿¡<a href="https://github.com/facebook/react-native/blob/0150bc76eb8d2baa84ba040aead8131228c1185e/Libraries/Components/WebView/WebView.ios.js#L506" target="_blank" rel="noopener">https://github.com/facebook/react-native/blob/0150bc76eb8d2baa84ba040aead8131228c1185e/Libraries/Components/WebView/WebView.ios.js#L506</a></p>
<ul>
<li>åœ¨RNä¸­ <code>onMessage</code>è´Ÿè´£æ¥æ”¶Weviewçš„æ¶ˆæ¯ <code>postMessage</code> è´Ÿè´£å‘é€æ¶ˆæ¯ç»™Webview</li>
<li>é€šè¿‡ç›‘å¬<code>message</code>äº‹ä»¶æ¥æ¥æ”¶RNçš„æ¶ˆæ¯ï¼Œé€šè¿‡<code>window.postMessage</code>åœ¨Webviewä¸­å‘RNä¸­å‘é€æ¶ˆæ¯ </li>
</ul>
<p>äºæ˜¯å†™ä»£ç éªŒè¯ä¸‹ã€‚åœ¨htmlä¸­æ”¾ç½®ä¸¤ä¸ªè¾“å…¥æ¡†Aã€B,ç‚¹å‡»æŒ‰é’®æŠŠAã€Bçš„å€¼å‘é€ç»™RNç«¯ï¼Œè¿”ä¼šä¸¤ä¸ªæ•°çš„å’Œå¹¶å±•ç¤º</p>
<h4 id="H5çš„ä»£ç "><a href="#H5çš„ä»£ç " class="headerlink" title="H5çš„ä»£ç "></a>H5çš„ä»£ç </h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  &lt;div style=&quot;padding-top:50px;&quot;&gt;</span><br><span class="line">      &lt;input id=&apos;A&apos; /&gt; </span><br><span class="line">      &lt;input id=&apos;B&apos; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;Button id=&apos;cacl&apos;&gt;è®¡ç®—&lt;/Button&gt; &lt;span&gt;ABç›¸åŠ ä¸º&lt;/span&gt;&lt;span id=&apos;sum&apos;&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> var bt= document.getElementById(&apos;cacl&apos;);</span><br><span class="line"> bt.addEventListener(&apos;click&apos;,function()&#123;</span><br><span class="line">   var valA = document.getElementById(&apos;A&apos;).value;</span><br><span class="line">   var valB = document.getElementById(&apos;B&apos;).value;</span><br><span class="line">   window.postMessage(JSON.stringify(&#123;</span><br><span class="line">         type:&apos;add&apos;,</span><br><span class="line">         data:&#123;</span><br><span class="line">           A:valA,</span><br><span class="line">           B:valB</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;))</span><br><span class="line"> &#125;);</span><br><span class="line">document.addEventListener(&apos;message&apos;,function(e)&#123;</span><br><span class="line">   document.getElementById(&apos;sum&apos;).innerText = JSON.parse(e.data).result;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="RN-ä¸­çš„ä»£ç "><a href="#RN-ä¸­çš„ä»£ç " class="headerlink" title="RN ä¸­çš„ä»£ç "></a>RN ä¸­çš„ä»£ç </h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> export default class RNWebbViewMessage extends Component &#123;</span><br><span class="line">  constructor(props)&#123;</span><br><span class="line">    super(props);</span><br><span class="line">      this.onMessage = this.onMessage.bind(this);</span><br><span class="line">  &#125;</span><br><span class="line">   onMessage(e)&#123;</span><br><span class="line">      var event =e.nativeEvent;</span><br><span class="line">      var data=JSON.parse(event.data);</span><br><span class="line">      if(data.type ===&apos;add&apos;)&#123;</span><br><span class="line">        let  args= data.data;</span><br><span class="line">        let a = Number(args.A);</span><br><span class="line">        let b = Number(args.B);</span><br><span class="line">        this.refs.webviewRef.postMessage(JSON.stringify(&#123;</span><br><span class="line">            result:a+b</span><br><span class="line">         &#125;))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;View style=&#123;&#123;flex:1&#125;&#125;&gt;</span><br><span class="line">          &lt;WebView ref=&#123;&apos;webviewRef&apos;&#125; automaticallyAdjustContentInsets=&#123;false&#125; onMessage=&#123;this.onMessage&#125; javaScriptEnabled=&#123;true&#125; source=&#123;&#123;uri:&apos;http://localhost/work/study/rnwebviewmessage/index.html?ss&apos;&#125;&#125; /&gt; </span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡éªŒè¯ç»“è®ºæ˜¯æˆç«‹çš„ã€‚</p>
<ul>
<li>webviewç½‘é¡µå¯ä»¥ä½¿ç”¨<code>window.postMessage</code> å‘é€æ¶ˆæ¯ï¼Œ <code>document.addEventListener(&#39;message&#39;,callback)</code>æ¥ç›‘å¬æ¶ˆæ¯</li>
<li>RN ä¸­onMessage é€šè¿‡ å‚æ•°ä¸­nativeEvent.dataè·å¾—webviewä¼ é€’è¿‡æ¥çš„å­—ç¬¦ä¸²ã€‚ç„¶åæŠŠç»“æœé€šè¿‡webviewå®ä¾‹çš„postMessageæ–¹æ³•å‘é€åˆ°H5ä¸­</li>
</ul>
<p>ä»¥ä¸Šåªæ˜¯é€šä¿¡apiçš„ä»‹ç»ï¼Œå¦‚æœç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨çš„è¯ï¼Œè¿˜å¯ä»¥å¯¹è°ƒç”¨å½¢å¼è¿›ä¸€æ­¥å°è£…ï¼Œæ¯”å¦‚H5ä¸­æ–¹æ³•è°ƒç”¨RNä¸­çš„åˆ†äº«ï¼Œå¹¶ä¸”è¦æ±‚çŸ¥é“åˆ†äº«ç»“æœæ˜¯å¦æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨ <code>webviewBridgecallRN(&#39;share&#39;,{title:&#39;å¾®ä¿¡åˆ†äº«&#39;ï¼Œcontent:&quot;åˆ†äº«å†…å®¹&quot;},callback)</code>è¿™ç§ç±»ä¼¼çš„æ–¹å¼ï¼ŒåŒæ—¶RNä¸­å¯æ ¹æ®äº‹ä»¶çš„åå­—è¿›è¡Œåˆ†æ¨¡å—æ¥å®ç°ã€‚</p>
<h5 id="å¤‡æ³¨"><a href="#å¤‡æ³¨" class="headerlink" title="å¤‡æ³¨"></a>å¤‡æ³¨</h5><ul>
<li>æŸ¥é˜…äº†react-nativeçš„Webviewæºç å˜æ›´è®°å½•  <code>onMessage/postMessage</code>æ˜¯ä» 0.37 ç‰ˆæ‰æ”¯æŒçš„ã€‚androidä¸iosçš„æ”¯æŒç‰ˆæœ¬åŒæ­¥ã€‚</li>
<li>ä¹‹å‰rn webview é€šä¿¡å¯ä»¥ä½¿ç”¨ <a href="react-native-webview-bridge">https://github.com/alinz/react-native-webview-bridge</a></li>
</ul>

        

      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/React-React-Native/">
                #React React-Native
              </a>
            
          </div>
        

        

        
          <div class="post-eof the-shape"></div>
        
      </div>
    
  </div>


  
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2016/03/05/React-createClass-VS-React-Component/">
                React.createClass VS React.Component
              </a>
            
          
        </h1>
      

      <div class="post-meta">
          <span class="post-time">
            
              å‘è¡¨äº 2016-03-05
            
          </span>
        
          
            <span class="post-comments-count">
            &nbsp; | &nbsp;
            <a href="/2016/03/05/React-createClass-VS-React-Component/#comments">
              <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/05/React-createClass-VS-React-Component/"></span>
            </a>
          </span>
          
        
      </div>
    </div>

    
      <div class="post-body">

        
        

        
          <p>åˆ›å»ºreactç»„ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼Œä½¿ç”¨ç”¨ <code>React.createClass</code> ä»¥åŠç”¨es6æ¨¡å—åŒ–çš„æ–¹å¼<code>extends React.Component</code> é€šè¿‡é›†æˆ <code>Component</code> ç»„ä»¶ç±»çš„å½¢å¼æ¥å®ç°ã€‚ä¸¤è€…çš„ä½œç”¨ç±»ä¼¼ï¼Œåè€…æ˜¯æ–°çš„è¯­æ³•ä¹Ÿæ˜¯è¶‹åŠ¿ã€‚äºæ˜¯èµ¶ç´§å¯¹æ¯”ä¸‹å¦‚ä½•å‡çº§åˆ°æ–°çš„è¯­æ³•</p>
<h3 id="React-createClass"><a href="#React-createClass" class="headerlink" title="React.createClass"></a>React.createClass</h3><h3 id="creatClassåˆ›å»ºçš„ç»„ä»¶èµ‹å€¼ä¸ºconstç±»å‹çš„å˜é‡ï¼Œåœ¨ç»„ä»¶å†…éƒ¨å®ç°å¿…è¦çš„-renderå‡½æ•°"><a href="#creatClassåˆ›å»ºçš„ç»„ä»¶èµ‹å€¼ä¸ºconstç±»å‹çš„å˜é‡ï¼Œåœ¨ç»„ä»¶å†…éƒ¨å®ç°å¿…è¦çš„-renderå‡½æ•°" class="headerlink" title="creatClassåˆ›å»ºçš„ç»„ä»¶èµ‹å€¼ä¸ºconstç±»å‹çš„å˜é‡ï¼Œåœ¨ç»„ä»¶å†…éƒ¨å®ç°å¿…è¦çš„ renderå‡½æ•°"></a>creatClassåˆ›å»ºçš„ç»„ä»¶èµ‹å€¼ä¸º<code>const</code>ç±»å‹çš„å˜é‡ï¼Œåœ¨ç»„ä»¶å†…éƒ¨å®ç°å¿…è¦çš„ <code>render</code>å‡½æ•°</h3><pre><code>import React from &apos;react&apos;;
const Contacts = React.createClass({
  render() {
    return (
      &lt;div&gt;&lt;/div&gt;
    );
  }
});
export default Contacts;
</code></pre><h3 id="React-Component"><a href="#React-Component" class="headerlink" title="React.Component"></a>React.Component</h3><p>é€šè¿‡ES6çš„ç±»ç»§æ‰¿æ¨¡å¼åœ¨ æ„é€ å‡½æ•°é‡Œé¢è¦ å…ˆé€šè¿‡<code>super(props)</code>è°ƒç”¨çˆ¶ç»„ä»¶çš„æ„é€ å‡½æ•°</p>
<pre><code>import React from &apos;react&apos;;
class Contacts extends React.Component {
  constructor(props) {
    super(props);
  }
  render() {
    return (
      &lt;div&gt;&lt;/div&gt;
    );
  }
}
export default Contacts;
</code></pre><h2 id="propTypes-and-getDefaultProps"><a href="#propTypes-and-getDefaultProps" class="headerlink" title="propTypes and getDefaultProps"></a>propTypes and getDefaultProps</h2><h3 id="React-createClass-1"><a href="#React-createClass-1" class="headerlink" title="React.createClass"></a>React.createClass</h3><pre><code>import React from &apos;react&apos;;
const Contacts = React.createClass({
  propTypes: {

  },
  getDefaultProps() {
    return {

    };
  },
  render() {
    return (
      &lt;div&gt;&lt;/div&gt;
    );
  }
});
export default Contacts;
</code></pre><h3 id="React-Component-1"><a href="#React-Component-1" class="headerlink" title="React.Component"></a>React.Component</h3><p>ç»™ç±»å¢åŠ å±æ€§çš„æ–¹å¼å‘ç”Ÿäº†å˜åŒ–ï¼Œ<code>defaultProps</code> æ¥æ›¿ä»£ <code>getDefaultProps()</code> ä¼¼ä¹ç®€å•äº†ä¸å°‘</p>
<pre><code>import React from &apos;react&apos;;
class Contacts extends React.Component {
  constructor(props) {
    super(props);
  }
  render() {
    return (
      &lt;div&gt;&lt;/div&gt;
    );
  }
}
Contacts.propTypes = {
};
Contacts.defaultProps = {
};
export default Contacts;
</code></pre><h2 id="çŠ¶æ€å®šä¹‰-State"><a href="#çŠ¶æ€å®šä¹‰-State" class="headerlink" title="çŠ¶æ€å®šä¹‰ State"></a>çŠ¶æ€å®šä¹‰ State</h2><pre><code>import React from &apos;react&apos;;
const Contacts = React.createClass({
  getInitialState () {
    return {

    };
  },
  render() {
    return (
      &lt;div&gt;&lt;/div&gt;
    );
  }
});
export default Contacts;
</code></pre><p>å®šä¹‰é»˜è®¤çš„çŠ¶æ€åœ¨æ„é€ å‡½æ•°ä¸­å®ç°æ¥å–ä»£äº† <code>getInitialState</code>,è¯­æ³•æ›´ç®€å•</p>
<pre><code>import React from &apos;react&apos;;
class Contacts extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
    };
  }
  render() {
    return (
      &lt;div&gt;&lt;/div&gt;
    );
  }
}
export default Contacts;
</code></pre><h3 id="thisçš„å«ä¹‰ä¸åŒ"><a href="#thisçš„å«ä¹‰ä¸åŒ" class="headerlink" title="thisçš„å«ä¹‰ä¸åŒ"></a>thisçš„å«ä¹‰ä¸åŒ</h3><p>åœ¨ <code>React.createClass</code>ä¸­ï¼Œç»™ç»„ä»¶ç»‘å®šäº‹ä»¶çš„å‡½æ•°ä¸­çš„ <code>this</code> æŒ‡å‘å½“å‰çš„ç»„ä»¶ ï¼Œåœ¨ <code>React.Component</code> ä¸­äº‹ä»¶å‡½æ•°ä¸­çš„ <code>this</code> é»˜è®¤æŒ‡å‘ä¸ºç©º</p>
<pre><code>import React from &apos;react&apos;;
const Contacts = React.createClass({
  handleClick() {
    console.log(this); // ä½†å‰çš„ç»„ä»¶å®ä¾‹
  },
  render() {
    return (
      &lt;div onClick={this.handleClick}&gt;&lt;/div&gt;
    );
  }
});
export default Contacts;

import React from &apos;react&apos;;
class Contacts extends React.Component {
  constructor(props) {
    super(props);
  }
  handleClick() {
    console.log(this); // null
  }
  render() {
    return (
      &lt;div onClick={this.handleClick}&gt;&lt;/div&gt;
    );
  }
}
export default Contacts;
</code></pre><p>å¯ä»¥åœ¨ç»‘å®šäº‹ä»¶çš„æ—¶å€™ä½¿ç”¨ JSä¸­çš„bindæ¥ç»‘å®šthis å¯¹è±¡ <code>&lt;div onClick={this.handleClick.bind(this)}&gt;&lt;/div&gt;</code>ä¹Ÿå¯ä»¥åœ¨ æ„é€ å‡½æ•°é‡Œé¢æ‰‹åŠ¨çš„ bind <code>this.handleClick = this.handleClick.bind(this);</code></p>
<pre><code>import React from &apos;react&apos;;
class Contacts extends React.Component {
  constructor(props) {
    super(props);
    this.handleClick = this.handleClick.bind(this);
  }
  handleClick() {
    console.log(this); // React Component instance
  }
  render() {
    return (
      &lt;div onClick={this.handleClick}&gt;&lt;/div&gt;
    );
  }
}
export default Contacts;
</code></pre><h3 id="Mixins"><a href="#Mixins" class="headerlink" title="Mixins"></a>Mixins</h3><p>ä½¿ç”¨mixinså¯ä»¥æé«˜å¤ç”¨æ€§ï¼Œ<code>React.Component</code> ä¸å†æ”¯æŒ <code>Mixins</code>ã€‚</p>
<pre><code>import React from &apos;react&apos;;
var SomeMixin = {
  doSomething() {
  }
};
const Contacts = React.createClass({
  mixins: [SomeMixin],
  handleClick() {
    this.doSomething(); // use mixin
  },
  render() {
    return (
      &lt;div onClick={this.handleClick}&gt;&lt;/div&gt;
    );
  }
});
export default Contacts;
</code></pre><p>åœ¨ React.Component å®˜æ–¹æ¨è <a href="https://leozdgao.me/chushi-hoc/" target="_blank" rel="noopener">HOC(é«˜é˜¶ç»„ä»¶)çš„å½¢å¼</a> æ¥æ›¿æ¢ï¼Œå¦‚æœä¸€å®šè¦ä½¿ç”¨ mixçš„è¯ ä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="https://github.com/brigand/react-mixin" target="_blank" rel="noopener">react-mixin</a></p>

        

      </div>
    

    
      <div class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/React/">
                #React
              </a>
            
          </div>
        

        

        
          <div class="post-eof the-shape"></div>
        
      </div>
    
  </div>


  

          </div>

          
            <div class="pagination">
              <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/2/">&raquo;</a>
            </div>
          
        </div>

        
<div class="sidebar-toggle">
  <div class="sidebar-toggle-line-wrap">
    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
  </div>
</div>

<div id="sidebar" class="sidebar">
  <div class="sidebar-inner">

    

    <div class="site-overview">
      <div class="site-author motion-element">
        <img class="site-author-image" src="http://ww4.sinaimg.cn/bmiddle/6c92bd39gw1ekj8t033tvj206p0663yr.jpg" alt="kunkun">
        <p class="site-author-name">kunkun</p>
      </div>
      <p class="site-description motion-element"></p>
      <div class="site-state motion-element">
        <div class="site-state-item site-state-posts">
          <span class="site-state-item-count">51</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </div>
        <div class="site-state-item site-state-tags">
            <span class="site-state-item-count">29</span>
            <span class="site-state-item-name">æ ‡ç­¾</span>
        </div>
        <div class="site-state-item site-state-pages">
            <span class="site-state-item-count">2</span>
            <span class="site-state-item-name">é¡µé¢</span>
        </div>
      </div>

      

      <div class="social-info motion-element">
        
          
            <span class="soclial-item">
              <a href="https://github.com/kunkun12">GITHUB</a>
            </span>
          
            <span class="soclial-item">
              <a href="https://twitter.com/dubaokun">TWITTER</a>
            </span>
          
            <span class="soclial-item">
              <a href="http://weibo.com/u/1821556025">WEIBO</a>
            </span>
          
            <span class="soclial-item">
              <a href="http://www.zhihu.com/people/du-bao-kun-61">ZHIHU</a>
            </span>
          
        
      </div>

    </div>

    
  </div>
</div>


      </div>
    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2018
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">kunkun</span>
</div>

<div class="powered-by">
  ç”± <a class="theme-link" href="http://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT</a>
</div>





      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $(".fancybox").fancybox();
    });
  </script>

  <script type="text/javascript">
  function isDesktop () {
    return screen.width > 991;
  }

  function isTablet () {
    return screen.width < 992 && screen.width > 767;
  }

  function isMobile () {
    return screen.width < 767;
  }

  function escapeSelector (selector) {
    return selector.replace(/[!"$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g, "\\$&")
  }
</script>

  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  
  <script type="text/javascript" id="motion.page.home">
    $(document).ready(function () {
      $.Velocity.RunSequence([
        { e: $('.brand'), p: { opacity: 1 }, o: { duration: 100 } },
        { e: $('.logo'), p: { opacity: 1, top: 0 }, o: { duration: 50} },
        { e: $('.site-title'), p: { opacity: 1, top: 0 }, o: { duration: 200, sequenceQueue: false } }
      ]);
      $('.menu-item').velocity('transition.slideDownIn', {display: null});
    });
  </script>


  <script type="text/javascript" id="motion.global">
  $(document).ready(function () {
    var body = $('body');
    var isSidebarVisible = false;
    var sidebarToggle = $('.sidebar-toggle');
    var sidebarToggleLine1st = $('.sidebar-toggle-line-first')
    var sidebarToggleLine2nd = $('.sidebar-toggle-line-middle');
    var sidebarToggleLine3rd = $('.sidebar-toggle-line-last');
    var sidebar = $('.sidebar');

    var SIDEBAR_WIDTH = '320px';
    var SIDEBAR_DISPLAY_DURATION = 300;

    var sidebarToogleLineStatusInit = {width: '100%', opacity: 1, left: 0, rotateZ: 0, top: 0};

    var sidebarToggleLine1stStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine1stStatusArrow = {width: '50%', rotateZ: '-45deg', top: '2px'};
    var sidebarToogleLine1stStatusClose = {width: '100%', rotateZ: '-45deg', top: '5px'};

    var sidebarToggleLine2ndStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine2ndStatusArrow = {width: '90%'};
    var sidebarToogleLine2ndStatusClose = {opacity: 0};

    var sidebarToggleLine3rdStatusInit = sidebarToogleLineStatusInit;
    var sidebarToggleLine3rdStatusArrow = {width: '50%', rotateZ: '45deg', top: '-2px'};
    var sidebarToogleLine3rdStatusClose = {width: '100%', rotateZ: '45deg', top: '-5px'};

    sidebatToggleMotion();
    postsListMotion();
    backToTopMotion();


    $(document)
      .on('sidebar.show', function () {
        isDesktop() && body.velocity(
          {paddingRight: SIDEBAR_WIDTH},
          SIDEBAR_DISPLAY_DURATION
        );
        sidebarContentMotion();
      })
      .on('sidebar.hide', function () {

      });


    function backToTopMotion () {
      var b2top = $('.back-to-top');
      b2top.on('click', function () {
        body.velocity('scroll');
      });
    }

    function sidebarShowMotion () {

      sidebarToggleLine1st.velocity(sidebarToogleLine1stStatusClose);
      sidebarToggleLine2nd.velocity(sidebarToogleLine2ndStatusClose);
      sidebarToggleLine3rd.velocity(sidebarToogleLine3rdStatusClose);

      sidebar.velocity({width: SIDEBAR_WIDTH}, SIDEBAR_DISPLAY_DURATION);
      sidebar.trigger('sidebar.show');
    }

    function sidebarHideMotion () {
      isDesktop() && body.velocity({paddingRight: 0});
      sidebar.velocity('reverse');

      sidebarToggleLine1st.velocity(sidebarToggleLine1stStatusInit);
      sidebarToggleLine2nd.velocity(sidebarToggleLine2ndStatusInit);
      sidebarToggleLine3rd.velocity(sidebarToggleLine3rdStatusInit);

      sidebar.trigger('sidebar.hide');
    };

    function sidebarContentMotion () {
      $('.sidebar .motion-element').velocity(
        'transition.slideRightIn',
        {stagger: 50, drag: true}
      );
    }

    function postsListMotion () {
      $('.post').velocity('transition.slideDownIn', {stagger: 300, drag: true});
    }

    function sidebatToggleMotion () {
      sidebarToggle.on('click', function () {
        isSidebarVisible ? sidebarHideMotion() : sidebarShowMotion();
        isSidebarVisible = !isSidebarVisible;
      });

      sidebarToggle.hover(function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusArrow);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusArrow);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusArrow);
      }, function () {
        if (isSidebarVisible) {return}
        sidebarToggleLine1st.velocity('stop').velocity(sidebarToggleLine1stStatusInit);
        sidebarToggleLine2nd.velocity('stop').velocity(sidebarToggleLine2ndStatusInit);
        sidebarToggleLine3rd.velocity('stop').velocity(sidebarToggleLine3rdStatusInit);
      });
    }
  });

</script>





  

  

  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"kunkun12"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
  
</body>
</html>
